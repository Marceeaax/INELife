{Application 'VAL_CONSISTENCIA' logic file generated by CSPro}
PROC GLOBAL
NUMERIC XLARGO_RUTA;
STRING PFFNAME, ENTNAME, PFFCONSIS, ENTCONSIS, XRUTA_MENU, F_RUTA_DPTO, F_RUTA_DIST, F_RUTA_UPM, NAMEFILE;
STRING FXDATA, FDATAVAL, FILE_QNAMEX,Dir_main;
FILE PFFILE;//,tempFile;
// TEMPFILE01, TEMPFILE02, TEMPFILE03;
numeric xval_01,xval_02,xval_03, xval_04, xval_05, xval_06, xval_07, xval_08, xval_09, xval_10, htval1;
numeric X, i, j, F, L, N;
string dir_existe02, aux_sysD, aux_ruta_wrt02,aux_ruta_note02,xoperacion;


string aux_upm02, aux_dist02, aux_dpto02;//,aux_depdis;aux_post
string aux_bar02, aux_area02, aux_cod_usr;  
string ASITU, ASITUV;

numeric AANO, ADIAD, ADIAH, AMESD, AMESH;
numeric FECHAV1, FECHAV2, CTAVISI, AFPV;
numeric  fecha_ref, MINUTOS, DVISITA;
//numeric persel;
numeric personaselec;
numeric perselect2;
numeric C;
numeric difed, afv, cump, PCump, acum, pacum, D15AC, D15AN;
array V(3,30);

numeric ULTDIAV, ULTMESV, ULTANOV, ULTSITU, ULTVISI, UFV, AUXSITU;
string ULTSITUE;
numeric PERSONA, EDAD, found, ENCONTRO, EDADREG01;

numeric EMPDOM,ANHOBIS,BISIES,K ;
numeric DN, MDN, XEDAD,  MINED,XNIVE,XGRAD,DUPL, XCUMP  ;
numeric MDE;
numeric LJEF,JEFE,ESPOSA,ECIVJ;
numeric ECIVC,SEXOJ,SEXOC,AUXTOT, CUENTA, TOTALL;
numeric AUXHOM,AUXMUJ,AUXOTRO,AUXPRENR,EDADJ;
numeric EDADH,EDADC,BANC, AUXDIFE, LOOP, RPA01A,RPT02, only_consis, only_html;

string AUX_RUTA,AUX_CLAVE;

 array ctrper(35,4);
 array ctrlin(35,3);
 array VINDEP(7);
 
//parámetros para volver al menu principal
string user_cod,user_nam,user_pin,user_irole,user_menu,user_capi,user_type;
string capi_auxfil;

numeric XPOSIT,XCANT,LEN2,LEN3,XPOST2,XPOS_COM,XPOS_PY;
string AUXMAIL,AUXDOMINIO1,AUXDOMINIO2;

//****************************
Function RunListado()
//****************************

     string sname_val,sname_val_NOTA, ruta_listado, dir_existe_NOTA ;
    
	xlargo_ruta=length(pathname(Application));
		    
    //*sname_val = edit("99999",(UPM)) + edit("999",(NVIVI)) + edit("9",(NHOGA)) + "_" + strip(aux_sysD);
	sname_val = strip(aux_upm02)  + "_" + strip(aux_sysD);
	
	//*sname_val_NOTA = edit("99999",(UPM)) + edit("999",(NVIVI)) + edit("9",(NHOGA)) + "_" + strip(aux_sysD);
	sname_val_NOTA = strip(aux_upm02) + "_" + strip(aux_sysD);

	string dir_existe,backupFolder;
	
	//dir_existe        = pathconcat(Application, "Listados",concat( strip(sname_val), ".qst"));
	dir_existe02      = pathconcat(Dir_main, "Listados",concat( strip(sname_val), ".txt"));
				//errmsg("1 dir_existe02  %s",dir_existe02 );

    //dir_existe_NOTA   = pathconcat(Application, "Tmpval",concat( strip(sname_val_NOTA), ".TX3"));
		
		//backupFolder = pathname(Application)+ "Listados\";
		{string LINE;
		SETFILE(TEMPFILE01, dir_existe02);
		
		FILECREATE(TEMPFILE01);
		
		IF FILEEXIST(dir_existe) THEN
		   SETFILE(TEMPFILE02, dir_existe);
		   
		   WHILE FILEREAD(TEMPFILE02, LINE) DO
		   	
		      FILEWRITE(TEMPFILE01, LINE);
		   
		   ENDDO;
		ENDIF;}
		{FILEWRITE(TEMPFILE01, "                                      ");
		FILEWRITE(TEMPFILE01, "----------------------------------------------------");
	    FILEWRITE(TEMPFILE01, "                   LISTADO DE NOTAS");
		FILEWRITE(TEMPFILE01, "----------------------------------------------------");
		FILEWRITE(TEMPFILE01, "                                      ");
		
		IF FILEEXIST(dir_existe_NOTA) THEN 
		   SETFILE(TEMPFILE03, dir_existe_NOTA);
		   
		   WHILE FILEREAD(TEMPFILE03, LINE) DO
		  
		      FILEWRITE(TEMPFILE01, LINE);
		   
		   ENDDO;
		 
		ENDIF;
		CLOSE(TEMPFILE01);}
		
		
	if fileexist(dir_existe02) then
	
		if getos() in 20:29 then
	        //Android - use "view:"
			
			dir_existe02 = pathconcat(Dir_main, "Listados",concat( strip(sname_val),".txt"));	
			//execsystem("html:file:///" + dir_existe02);			
			//errmsg("dir_existe02  %s",dir_existe02 );
			execsystem("view:" + pathconcat(Dir_main,dir_existe02));
			
	    else
	        // Windows - use "explorer.exe <filename>"
			 dir_existe02 = pathconcat(Dir_main, "Listados",concat( strip(sname_val),".txt"));
			
             string TheCommand;
	         if FileExist("C:\Program Files (x86)\CSPro 7.7\TextView.exe") then
	            TheCommand = concat('"C:\Program Files (x86)\CSPro 7.7\TextView.exe" "', strip(dir_existe02), '"' );
	         else     
	            TheCommand = concat('"C:\Program Files\CSPro 7.7\TextView.exe" "', strip(dir_existe02), '"' );
	         endif;
	
		     ExecSystem( strip(TheCommand), maximized, wait );
		endif;  
	else	
	   errmsg("Listado no existe %s",dir_existe02);
	   exit;
	endif;

end;
//****************************
 FUNCTION CERAR_POB()
   LJEF   = 0;
   JEFE   = 0;
   ESPOSA = 0;
   ECIVJ  = 0;
   ECIVC  = 0;
   SEXOJ  = 0;
   SEXOC  = 0;
   AUXTOT = 0;
   AUXHOM = 0;
   AUXMUJ = 0;
   AUXotro = 0;
   AUXPRENR = 0;
   EDADJ  = 0;
   EDADH  = 0;
   EDADC  = 0;
   BANC   = 0;
 END;
 {---------------------------}


//>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
FUNCTION VALIDAR_CORREO(ALPHA(70) VAR_EMAIL,ALPHA(30) VARNAME) 
//>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  XPOSIT= pos("@",STRIP(VAR_EMAIL));
  
  XCANT=poschar("@",STRIP(VAR_EMAIL));
  LEN2 = length(strip(VAR_EMAIL));
  
  AUXMAIL=strip(VAR_EMAIL)[XPOSIT];
  
  XPOST2= pos(".",STRIP(AUXMAIL));
  
  LEN3 =(XPOSIT - 1);
  
	//FILEWRITE(PFFILE," ERR_P00B 888,XPOSIT %d  ", XPOSIT); 

 {---------------------------------------------------------------------------------------------------------------------}           
  IF XPOSIT = 0 THEN
     // CONTROLA();
		errmsg("ERR_P00B 888, Pág. 1, %s no tiene el @[%s]", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50]); 

     // ERRMSG("ERR_P00B 888, Pág. 1, %s no tiene el @[%s]", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50]); 
		errmsg("-------------------"); 
     
     // WRITE ("ERR_P00B 888, Pág. 1, %s no tiene el @[%s]", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50]);
   //   WRITE ("-------------------");   
  ELSE
	  IF LEN3 < 3 THEN
	   //   CONTROLA();
	      errmsg("VER_P00B 886, Pág. 1, %s no puede tener nombre < a 3 caracteres[%s] antes del @", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50]);      
	     // WRITE ("VER_P00B 886, Pág. 1, %s no puede tener nombre < a 3 caracteres[%s] antes del @", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50]);
	      errmsg("-------------------");   
	  ENDIF;
	 
	  IF LEN2 < 6 THEN
	   //   CONTROLA();
	      errmsg("ERR_P00B 887, Pág. 1, %s no puede ser < a 6 caracteres[%s]", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50]);      
	      errmsg("ERR_P00B 887, Pág. 1, %s no puede ser < a 6 caracteres[%s]", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50]);
	      errmsg("-------------------");   
	  ENDIF;
  
      IF XPOSIT = 1 THEN
	   //   CONTROLA();
	      errmsg("ERR_P00B 889, Pág. 1, %s el @ no puede estar en el 1er. lugar [%s]", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50]);      
			errmsg("ERR_P00B 889, Pág. 1, %s el @ no puede estar en el 1er. lugar [%s]", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50]);
	      errmsg("-------------------");   
      ENDIF;

      IF XPOSIT = LEN2 THEN
	    //  CONTROLA();
	      errmsg("ERR_P00B 890, Pág. 1, %s el @ no puede estar al final[%s]", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50]);      
	      errmsg("ERR_P00B 890, Pág. 1, %s el @ no puede estar al final[%s]", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50]);
	      errmsg("-------------------");   
      ENDIF;
      
      {IF XCANT > 1 THEN
	      CONTROLA();
	      ERRMSG("ERR_P00B 891, Pág. 1, %s con más de un @[%s]", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50]);      
	      WRITE ("ERR_P00B 891, Pág. 1, %s con más de un @[%s]", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50]);
	      WRITE ("-------------------");   
      ENDIF;}
      IF VAR_EMAIL[(LEN2-2):1]= "." AND VAR_EMAIL[(LEN2-6):1]= "." THEN
	      IF VAR_EMAIL[(LEN2-2):1]= "." THEN
			 AUXDOMINIO2=".AF.AL.DZ.As.AD.AO.AI.AQ.AG.AP.AR.AM.AW.AU.AT.AZ.BS.BH.BD.BB.BY.BE.BZ.BJ.BM.BT.BO.BA.BW.BV.BR.IO.BN.BG.BF.MM.BI.KH.CM.CA.CV.KY.CF.TD.CL.CN.CX.CC.CO.KM.CG.CD.CK.CR.CI.HR.CU.CY.CZ.DK.DJ.DM.DO.TP.EC.EG.SV.GQ.ER.EE.ET.FK.FO.FJ.FI.CS.SU.FR.FX.GF.PF.TF.GA.GM.GE.DE.GH.GI.GB.GR.GL.GD.GP.GU.GT.GN.GW.GY.HT.HM.HN.HK.HU.IS.IN.ID.IR.IQ.IE.IL.IT.JM.JP.JO.KZ.KE.KI.KW.KG.LA.LV.LB.LS.LR.LY.LI.LT.LU.MO.MK.MG.MW.MY.MV.ML.MT.MH.MQ.MR.MU.YT.MX.FM.MD.MC.MN.MS.MA.MZ.NA.NR.NP.NL.AN.NT.NC.NZ.NI.NE.NG.NU.NF.KP.MP.NO.OM.PK.PW.PA.PG.PY.PE.PH.PN.PL.PT.PR.QA.RE.RO.RU.RW.GS.SH.KN.LC.PM.ST.VC.SM.SA.SN.SC.SL.SG.SK.SI.SB.SO.ZA.KR.ES.LK.SD.SR.SJ.SZ.SE.CH.SY.TJ.TW.TZ.TH.TG.TK.TO.TT.TN.TR.TM.TC.TV.UG.UA.AE.UK.US.UY.UM.UZ.VU.VA.VE.VN.VG.VI.WF.WS.EH.YE.YU.ZR.ZM.ZW";
			 
	         XPOS_PY=poschar(VAR_EMAIL[(LEN2-2):3],AUXDOMINIO2);
	         IF XPOS_PY = 0 THEN
//			      CONTROLA();
			      errmsg("ERR_P00B 891, Pág. 1, %s-[%s] con dominio [%s] no existe", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50],VAR_EMAIL[(LEN2-2):3]);      
					errmsg("ERR_P00B 891, Pág. 1, %s-[%s] con dominio [%s] no existe", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50],VAR_EMAIL[(LEN2-2):3]);
			      errmsg("-------------------");   
	         ENDIF;
	      ELSE
		      IF VAR_EMAIL[(LEN2-6):1]= "." THEN
		         AUXDOMINIO1=".COM.EDU.GOV.NET.BIZ.ORG.TV";	      
		         
	             XPOS_COM=poschar(VAR_EMAIL[(LEN2-6):3],AUXDOMINIO1);
		         IF XPOS_COM = 0 THEN
		//		      CONTROLA();
				      errmsg("ERR_P00B 891B, Pág. 1, %s-[%s] con dominio [%s] no existe", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50],VAR_EMAIL[(LEN2-2):3]);      
				      errmsg("ERR_P00B 891B, Pág. 1, %s-[%s] con dominio [%s] no existe", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50],VAR_EMAIL[(LEN2-2):3]);
				      errmsg("-------------------");   
		         ENDIF;
		      ENDIF;
	      ENDIF;
	  ENDIF;

      //CONTROLA SI EXISTE EL PUNTO ESTA BIEN POSICIONADO DESPUES DEL ARROBA
      IF VAR_EMAIL[(LEN2):1]= "." OR VAR_EMAIL[(LEN2-1):1]= "." THEN	  
	 //     CONTROLA();
	      errmsg("ERR_P00B 891C, Pág. 1, %s-[%s] no existe", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50]);      
	      errmsg("ERR_P00B 891C, Pág. 1, %s-[%s] no existe", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50]);
	      errmsg("-------------------");   
      ENDIF;
      
      //CONTROLA SI EXISTE UN PUNTO DESPUES DEL ARROBA
      IF XPOST2 = 0 THEN	  
//	      CONTROLA();
	      errmsg("ERR_P00B 891D, Pág. 1, %s-[%s] no tiene un (.) despues del @", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50]);      
	      errmsg("ERR_P00B 891D, Pág. 1, %s-[%s] no tiene un (.) despues del @", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50]);
	      errmsg("-------------------");   
	  ELSE
	      IF (XPOST2+LEN3) = (XPOSIT+1) THEN
//		      CONTROLA();
		      errmsg("ERR_P00B 889E, Pág. 1, %s el punto esta despues del @ [%s]", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50]);      
		      errmsg("ERR_P00B 889E, Pág. 1, %s el punto esta despues del @ [%s]", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50]);
		      errmsg("-------------------");   
	      ENDIF;

	      IF VAR_EMAIL[(LEN2-2):1]= "." THEN
			 AUXDOMINIO2=".AF.AL.DZ.As.AD.AO.AI.AQ.AG.AP.AR.AM.AW.AU.AT.AZ.BS.BH.BD.BB.BY.BE.BZ.BJ.BM.BT.BO.BA.BW.BV.BR.IO.BN.BG.BF.MM.BI.KH.CM.CA.CV.KY.CF.TD.CL.CN.CX.CC.CO.KM.CG.CD.CK.CR.CI.HR.CU.CY.CZ.DK.DJ.DM.DO.TP.EC.EG.SV.GQ.ER.EE.ET.FK.FO.FJ.FI.CS.SU.FR.FX.GF.PF.TF.GA.GM.GE.DE.GH.GI.GB.GR.GL.GD.GP.GU.GT.GN.GW.GY.HT.HM.HN.HK.HU.IS.IN.ID.IR.IQ.IE.IL.IT.JM.JP.JO.KZ.KE.KI.KW.KG.LA.LV.LB.LS.LR.LY.LI.LT.LU.MO.MK.MG.MW.MY.MV.ML.MT.MH.MQ.MR.MU.YT.MX.FM.MD.MC.MN.MS.MA.MZ.NA.NR.NP.NL.AN.NT.NC.NZ.NI.NE.NG.NU.NF.KP.MP.NO.OM.PK.PW.PA.PG.PY.PE.PH.PN.PL.PT.PR.QA.RE.RO.RU.RW.GS.SH.KN.LC.PM.ST.VC.SM.SA.SN.SC.SL.SG.SK.SI.SB.SO.ZA.KR.ES.LK.SD.SR.SJ.SZ.SE.CH.SY.TJ.TW.TZ.TH.TG.TK.TO.TT.TN.TR.TM.TC.TV.UG.UA.AE.UK.US.UY.UM.UZ.VU.VA.VE.VN.VG.VI.WF.WS.EH.YE.YU.ZR.ZM.ZW";
			 
	         XPOS_PY=poschar(VAR_EMAIL[(LEN2-2):3],AUXDOMINIO2);
			 
	         IF XPOS_PY = 0 THEN
//			      CONTROLA();
			      errmsg("ERR_P00B 891F, Pág. 1, %s-[%s] con dominio [%s] no existe", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50],VAR_EMAIL[(LEN2-2):3]);      
			      errmsg("ERR_P00B 891F, Pág. 1, %s-[%s] con dominio [%s] no existe", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50],VAR_EMAIL[(LEN2-2):3]);
			      errmsg("-------------------");   
	         ENDIF;
	      ELSE
		      IF VAR_EMAIL[(LEN2-3):1]= "." THEN
		         AUXDOMINIO1=".COM.EDU.GOV.NET.BIZ.ORG.TV";	      
		         
	             XPOS_COM=poschar(VAR_EMAIL[(LEN2-3):3],AUXDOMINIO1);
		         IF XPOS_COM = 0 THEN
//				      CONTROLA();
				      errmsg("ERR_P00B 891H, Pág. 1, %s-[%s] con dominio [%s] no existe", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50],VAR_EMAIL[(LEN2-2):3]);      
				      errmsg("ERR_P00B 891H, Pág. 1, %s-[%s] con dominio [%s] no existe", STRIP(VARNAME), STRIP(VAR_EMAIL)[1:50],VAR_EMAIL[(LEN2-2):3]);
				      errmsg("-------------------");   
		         ENDIF;
		      ENDIF;
	      ENDIF;
      ENDIF;
   ENDIF;
END;


PROC IMESPPBI_FF

PROC IDS0_EDT
{
numeric long_dir01,long_dir02,dif_length;

string ruta_directory = path.getDirectoryName(pathname(Application)); 

long_dir01=length("Program\");
long_dir02=length(ruta_directory);
dif_length=long_dir02 - long_dir01;

Dir_main= strip(ruta_directory)[1:dif_length];

//#write("directorio app: %s",Dir_main); 

aux_upm02 = CI_CLAVE;

//#write ("%s",aux_upm02);
}

aux_ruta_wrt02=sysparm("ruta_wrt");
aux_ruta_note02=sysparm("ruta_note");
xoperacion     =sysparm("x_operacion");
//*errmsg("ruta_wrt:%s",aux_ruta_wrt02);
aux_upm02 = CI_CLAVE;
PROC CI_CLAVE
postproc


PROC XVAL01

	string aux_post;
		forcase MARCO_DICT where UPMCG in strip(aux_upm02) do
			aux_post=MARCO_DICT.NAME_POST;

			aux_dpto02   = edit("9999",DEPDISCG)[1:2];
			aux_dist02   = edit("9999",DEPDISCG)[3:2];
			aux_bar02    = edit("999",BARRIOCG);
			aux_area02   = edit("9",AREACG);
			
		    found = 1;
	   endfor;
	   
	{   
	xlargo_ruta=length(pathname(Application)); 
    }
	aux_sysD = concat(edit("9999-99-99",sysdate("YYYYMMDD")), "_", edit("99-99-99",systime()));

	AUX_CLAVE= CONCAT(strip(aux_upm02) ,  "_" ,strip(aux_sysD)); 
 
    
    //AUX_RUTA=pathconcat(Dir_main, "Listados",concat(strip(AUX_CLAVE),".txt"));  
	
	AUX_RUTA=concat(aux_ruta_wrt02,"\",concat(strip(AUX_CLAVE),".txt"));  
	
	
	{
    //#write("ruta: %s",AUX_RUTA);
	//genera listados de consistencia
	}
	{
	setfile(PFFILE,strip(AUX_RUTA));
	
	IF fileexist(PFFILE) then filedelete(PFFILE); ENDIF;

	filecreate(PFFILE);
	}
	errmsg("");
	errmsg("-----------------------------------------------------------------");
	errmsg("LISTADO DE CONSISTENCIA - IMESPPBI - %s, %s",edit("99-99-9999",sysdate("DDMMYYYY")),EDIT("99:99:99",systime()));  
	errmsg("-----------------------------------------------------------------");
	
	errmsg("");
    errmsg("CI_CLAVE: %s  POSTULANTE: %s ", strip(aux_upm02),strip(aux_post));

	errmsg("");	

    //if strip(user_irole)  = "1" then	
	    string name_censita,aux_equicensista;
		forcase PSC_STAFF_DICT where STAFF_CODE in CENSISTA do

			name_censita = strip(STAFF_NAME);
			aux_equicensista   = edit("999",STAFF_EQUIP);
	   endfor;
	   
		errmsg("Equipo: %s    Censista: %03d [%s]",aux_equicensista,CENSISTA, name_censita);
	//endif;

	{
    if strip(user_irole)  = "1" then	
		errmsg("Censista: %s [%s]", user_cod, user_nam);
	endif;
	}
    errmsg("======================================================================================");

//a patir de aqui

	errmsg("-----------------------------------------");                  
	errmsg(" SITUACION / UBICACION / BIENES DURADEROS");
	errmsg("-----------------------------------------");                  
   
   //#forcase IMESPPBI_DICT where CI_CLAVE <>"" do  
   

   ASITU = "                           ";
   // R200429 ABRE VERIFICAR
  // DO VARYING i = 1 WHILE i <= count(LLAMADAS)
      IF (SITU) =  1 THEN ASITU = "Completa";       ENDIF;
	  IF (SITU) =  2 THEN ASITU = "Incompleta"; 	ENDIF;   
      IF (SITU) =  3 THEN ASITU = "Otra situación"; ENDIF;   
 //  ENDDO;
 
   errmsg("Resultado. últ. visita: %s  ", STRIP(ASITU));
   errmsg("-----------------------------------------------------------------------------");


  //------------------------------------------
  // CONTROL DE CODIGO GEOGRAFICO
  //------------------------------------------

   found = 0;

   //UPMCG = tonumber(aux_upm02);

   setfile(MARCO_DICT,pathconcat(Application,  "marco.csdb"));
   
   
   
   forcase MARCO_DICT where UPMCG in strip(aux_upm02)  do
      found = 1;
   endfor;
   
   CLOSE(MARCO_DICT);
   //CLOSE(PFFILEX);
   
   //found = loadcase (MARCO_DICT, UPMCG);

	string aux_DEPDIS = maketext("%04d", (DEPDIS));
	//    0


	numeric depto ;
	numeric distr ;
	
	if tonumber(aux_DEPDIS ) <> 0 then
		depto = tonumber(strip(aux_DEPDIS[1:2]));
		distr = tonumber(strip(aux_DEPDIS[3:4]));
	else
		depto =0;
		distr =0;
	endif;
 
   IF found = 1 then
       IF (depto <> tonumber(aux_dpto02)) OR (distr <> tonumber(aux_dist02)) or
           (AREAV)  <> tonumber(aux_area02)   THEN
         //CONTROLA();
         errmsg("ERROR, a. CODIGO GEOGRAFICO EN LA CLAVE NO CORRESPONDE A LA CEDULA: %S", strip(aux_upm02));
         errmsg("         Clave     Marco");
         errmsg("DepDis :  %04d      %04d",  tonumber(concat(edit("99",depto), edit("99",distr))), tonumber(concat(aux_dpto02,aux_dist02)) );
         errmsg("Area   :    %d         %d", (AREAV),   tonumber(aux_area02));
         errmsg("  ");
      ENDIF;

      IF tonumber(concat(edit("99",depto), edit("99",distr))) <> tonumber(concat(aux_dpto02,aux_dist02)) OR 
	     (AREAV) <> tonumber(aux_area02)  THEN
         //CONTROLA();
         errmsg("ERROR, b. Código Geográfico en Carátula <> Código Clave Geográfica");
         errmsg("         Código Carátula   Código UPM");
         errmsg("DepDis :      %04d            %04d ", tonumber(concat(edit("99",depto), edit("99",distr))), tonumber(concat(aux_dpto02,aux_dist02)) );
         errmsg("Area   :        %d               %d", (AREAV)  , tonumber(aux_area02));
         errmsg("  ");
         errmsg(" ");
      ENDIF;
  
   ELSE
      //CONTROLA();
      errmsg("ERROR, c. NO ENCONTRO CI_CLAVE: %S", strip(CI_CLAVE));
      errmsg("  ");
   ENDIF;  

    numeric auxname_cencista=0;
 
	forcase PSC_STAFF_DICT where STAFF_CODE = (CENSISTA) AND IROLE in 2 and ISTATUS in 1 do
		auxname_cencista=1;
		
		break;
	endfor;
	   
	//**close(PSC_STAFF_DICT);
   
   //IF NOT (ENCUES) IN 1:13, 300:310 THEN
   if auxname_cencista=0 then
      //CONTROLA();
      errmsg( "CC-ERR018, Código de Censista erróneo [%d]", (CENSISTA));
      errmsg("  ");
   ENDIF; 
   //--------------------------------------------------------------
   // Coordenadas
   //--------------------------------------------------------------
	   //# COORDENADA_Y=edit("ZZ9.999999",(ST_LATITUDE));
	   //# COORDENADA_X = edit("ZZZ9.999999",(ST_LONGITUDE));
	   
	   COORDENADA_Y=(ST_LATITUDE);
	   COORDENADA_X=(ST_LONGITUDE);
	   
	   IF (COORDENADA_X) IN NOTAPPL or (COORDENADA_Y) IN NOTAPPL  THEN       // 200727    // R200429
		  //CONTROLA();
		  errmsg("STR-K500, Coordenadas en BLANCO");   // 200727   // R200429
		  errmsg("Coordenada X : %d,",(COORDENADA_X) );
		  errmsg("Coordenada Y : %d,",(COORDENADA_Y) );
		  errmsg("  ");
	   ENDIF;

   //--------------------------------------------------------------
   // VALIDACION DE SITUACION Y FECHAS DE VISITA Y SITUACION FINAL
   //--------------------------------------------------------------
	   IF NOT (SITU) IN 1:3 THEN       // 200727    // R200429
		  //CONTROLA();
		  errmsg("STR-K0001, Situación de ENTREVISTA [%d] <> 1:3", (SITU));   // 200727   // R200429
		  errmsg("  ");
	   ENDIF;

	   IF (SITU) IN 1,2 AND strip(SITUE) <> " " THEN   // 200727   // R200429
		  //CONTROLA();
		  errmsg("STR-K0002, RESULTADO FINAL de la ENTREVISTA = [%d] -> Especifique = BLANCO", (SITU));
		  errmsg("           Especifique = %s", SITUE);
		  errmsg("  ");
	   ENDIF;
	   IF (SITU) IN 3 AND strip(SITUE) = " " THEN
		  //CONTROLA();
		  errmsg("STR-K0003, RESULTADO FINAL de la ENTREVISTA = [%d] -> Especifique <> BLANCO", (SITU));
		  errmsg("           Especifique = %s", SITUE);
		  errmsg("  ");
	   ENDIF;

  //*************************************************************************************************************************************** 
//}

   IF depto = Notappl or distr = Notappl then
      //CONTROLA();
      errmsg("ERROR4. Cabecera. Departamento y Distrito deben tener Código [%02d%02d]", depto,distr);
      errmsg("  ");
      errmsg(" ");
   ENDIF;

   IF NOT (AREA) IN 1, 6 then
      //CONTROLA();
      errmsg("ERROR5. Cabecera. ÁREA debe tener Código 1-URBANA, 6-RURAL [ %d]", (AREA));
      errmsg("  ");
      errmsg(" ");
   ENDIF;

   IF NOT (TENCUEST) IN 1, 2 then
      //CONTROLA();
      errmsg("ERROR6. Cabecera. Tipo de Censo debe tener Código. [ %d]", (TENCUEST));
      errmsg("  ");
      errmsg(" ");
   ENDIF;
   
  
      //----------------------------------------------------------------------------
   // VALIDACION PARA VIVIENDAS CON SITUACION COMPLETAS O INCOMPLETAS, SITU = 1,5 
   //----------------------------------------------------------------------------
		   IF (SITU) IN 1,2 THEN

			   IF STRIP(TELEF) = "" THEN     // BBB ABRE
				  //CONTROLA();
				  errmsg("VIV-ERR010, Pág X, Nº de TELEFONO [%s] en BLANCO", TELEF);
				  //errmsg("            Supervisor/a: %02d, Encuestador/a: %02d.", (SUPERV), (ENCUES));
				  errmsg("            Censista: %02d.", (CENSISTA));
				  errmsg("  ");
			   ENDIF;
			   
			   // R200422 ABRE AGREGAR
			   IF STRIP(TELEF) <> "" THEN
				  IF STRIP(TELEF) = "N/T" OR STRIP(TELEF) = "N/D" THEN
				  ELSE
					 IF length(strip(TELEF)) < 5 THEN
						errmsg("VIV-VER010A, Pág X, VER Nº de TELEFONO [%s]", TELEF);
						errmsg("    Distinto a N/T ó N/D ó Longitud menor a 5 dígitos");
						errmsg("  ");
					 ENDIF;
				  ENDIF;
			   ENDIF;	  
			   // R200422 CIERRA AGREGAR

//***********************************************************************************************************************

	DO VARYING X = 1 WHILE X <= count(REG_GENERAL) //*******DO X******
      //*errmsg("001- pasó por lista personas");
	  
      PERSONA = (L02(X));
      EDAD    = (LP103(X));	
		IF (L02(X)) = NotAppl THEN
			 //CONTROLA();
			 errmsg("ERR-L001-Lista, Línea de Persona = BLANCO [%d]", (L02(X)));
			 errmsg("  ");
		ENDIF;

	    IF not (L02(X)) = NotAppl THEN
		  IF STRIP(LP101(X)) = "" THEN                                                         
			 //CONTROLA();
			 errmsg("ERR-L002-Lista, Nombre del Censado = BLANCO");
			 errmsg("Lista de Personas");
			 errmsg("PERSONA: %02d, Nombre: %s", (L02(X)), LP101(X));   
			 errmsg("  ");
		  ELSE                                 // R200422 ABRE AGREGAR
			 IF LENGTH(STRIP(LP101(X))) < 10 THEN                                        
				//CONTROLA();
				errmsg("VER-L003-Lista, Nombre del Censado, longitud < 10");
				errmsg("Lista de Personas");
				errmsg("PERSONA: %02d, Nombre: %s", (L02(X)), LP101(X));  
				errmsg("  ");
			 ENDIF;                            // R200422 CIERRA AGREGAR
		  ENDIF;
		ENDIF;  
	
	ENDDO;
	
//************************************************************************************************************

			
 
//------------------------------------------------------------------------------------------------------------
		DO VARYING I = 1 WHILE I <= count (REG_GENERAL)
 
			  PERSONA = (L02(i));
				
			  // MIEMBRO  
			 //IF (LP102(I)) = 1 THEN     
			  
				 IF (GM104(I)) = 1 THEN
					AUXMUJ = AUXMUJ + 1;
				 ENDIF;
				 
				// errmsg("I %D (GM104(I)) %D AUXHOM %D",I,(GM104(I)),AUXHOM);

				 IF (GM104(I)) = 2 THEN
				 
					AUXHOM = AUXHOM + 1;

				 ENDIF;
				 
				 IF (GM104(I)) = 3 THEN
					AUXOTRO = AUXOTRO + 1;
				 ENDIF;
				 IF (GM104(I)) = 4 THEN
					AUXPRENR = AUXPRENR + 1;
				 ENDIF;
				 
				AUXTOT = AUXMUJ + AUXHOM + AUXOTRO + AUXPRENR;
				

				 IF (GM104(I)) = 99 THEN
					////CONTROLA();
					errmsg("POB-ERR005X,  Miembro del hogar con Sexo NR");
					errmsg("PERSONA: %02d, GM104: %d", PERSONA, (GM104(I)));
					errmsg("  ");
				 ENDIF;
 
			//  ENDIF; //FIN LP17= 1
			  
			 
	 
	   ENDDO; 
		
		
			IF (SITU) IN 1 THEN
				 IF AUXTOT <> (TOTALPERSONAS) THEN
					////CONTROLA();
					errmsg("POB-ERR010X,  Total de personas no coincide con contador de miembros");
					errmsg("Contador de miembros: %2D, Total Personas: %2d", AUXTOT, (TOTALPERSONAS));
					errmsg("  ");  
				 ENDIF;

				 IF AUXHOM <> (HOMBRES) THEN //TOTAL_HOMBRES
					////CONTROLA();
					errmsg("POB-ERR011X,  Total de hombres no coincide con contador de hombres");
					errmsg("Cuenta HOMBRES: %d, HOMBRES: %2d", AUXHOM, (HOMBRES)); 
					errmsg("  ");
				 ENDIF;

				 IF AUXMUJ <> (MUJERES) THEN   //TOTAL_MUJERES
					////CONTROLA();
					errmsg("POB-ERR012X,  Total de mujeres no coincide con contador de mujeres");
					errmsg("Cuenta MUJERES: %2d, MUJERES: %2d", AUXMUJ, (MUJERES));
					errmsg("  ");
				 ENDIF;
				 
				  IF AUXOTRO <> (OTROGEN) THEN //TOTAL_HOMBRES
					////CONTROLA();
					errmsg("POB-ERR013X,  Total de otros no coincide con contador de otros");
					errmsg("Cuenta otros: %d, otros: %2d", AUXOTRO, (OTROGEN)); 
					errmsg("  ");
				 ENDIF;

				 IF AUXPRENR <> (PREFNR) THEN   //TOTAL_MUJERES
					////CONTROLA();
					errmsg("POB-ERR014X,  Total de Prefiere no responder no coincide con contador de Prefiere no responder");
					errmsg("Cuenta Prefiere no responder : %2d, PRENR: %2d", AUXPRENR, (PREFNR));
					errmsg("  ");
				 ENDIF;


		   ENDIF;
		   
		   
		   
				//------------------------------------        
			   //HOMBRES, MUJERES, TOTAL MIEMBROS
			   //------------------------------------
			   IF (HOMBRES) = NotAppl THEN
				  //CONTROLA();
				  errmsg("VIV-ERR014, Pág. X, Total HOMBRES = BLANCO [HOMBRES: %2d].", (HOMBRES));
				  errmsg("  ");
			   ENDIF;
			
			   IF (MUJERES) = NotAppl THEN
				  //CONTROLA();
				  errmsg("VIV-ERR015, Pág. X, Total MUJERES = BLANCO [MUJERES: %2d].", (MUJERES));
				  errmsg("  ");
			   ENDIF;
			   
			   IF (OTROGEN) = NotAppl THEN
				  //CONTROLA();
				  errmsg("VIV-ERR016, Pág. X, Total OTRO = BLANCO [OTRO: %2d].", (OTROGEN));
				  errmsg("  ");
			   ENDIF;
			   
			   IF (PREFNR) = NotAppl THEN
				  //CONTROLA();
				  errmsg("VIV-ERR017, Pág. X, Total PREFNR = BLANCO [PREFNR: %2d].", (PREFNR));
				  errmsg("  ");
			   ENDIF;

			   IF (TOTAL) = NotAppl THEN
				  //CONTROLA();
				  errmsg("VIV-ERR01, Pág. X. Total MIEMBROS = BLANCO, [Total PERSONAS: %d].", (TOTAL));
				  errmsg("  ");
			   ENDIF;
		  ENDIF;

	     //----------------------------
      // REGISTRO DE POBLACION
      //----------------------------
    {  IF count(POBLACION) = 0 THEN
         //CONTROLA();
         errmsg("VIV-ERR017, Pág. X, RESULTADO FINAL = 1:5 y NO HAY registro población");
         errmsg("Situación del Hogar: %d, REG02: 0", (SITU));
         errmsg("  ");
      ENDIF;
	  }
	  
		IF (SITU) IN 3 THEN            // 200727                                                              // R200429

		  IF (HOMBRES) <> NotAppl THEN
			 //CONTROLA();
			 errmsg("VIV-ERR400, Pág. X, Situación cuestionario = 3 -> Total HOMBRES = BLANCO "); // 200727  // R200429
			 errmsg("SITUACION: %2d, HOMBRES: %d", (SITU), (HOMBRES));
			 errmsg("  ");
		  ENDIF;
		  
		  IF (MUJERES) <> NotAppl THEN
			 //CONTROLA();
			 errmsg("VIV-ERR401, Pág. X, Situación cuestionario = 3 -> Total MUJERES = BLANCO "); // 200727  // R200429
			 errmsg("SITUACION: %2d, MUJERES: %d", (SITU), (MUJERES));
			 errmsg("  ");
		  ENDIF;

		  IF (OTROGEN) <> NotAppl THEN
			 //CONTROLA();
			 errmsg("VIV-ERR402, Pág. X, Situación cuestionario = 3 -> Total HOMBRES = BLANCO "); // 200727  // R200429
			 errmsg("SITUACION: %2d, HOMBRES: %d", (SITU), (OTROGEN));
			 errmsg("  ");
		  ENDIF;
		  
		  IF (PREFNR) <> NotAppl THEN
			 //CONTROLA();
			 errmsg("VIV-ERR403, Pág. X, Situación cuestionario = 3 -> Total MUJERES = BLANCO "); // 200727  // R200429
			 errmsg("SITUACION: %2d, MUJERES: %d", (SITU), (PREFNR));
			 errmsg("  ");
		  ENDIF;

		  IF (TOTAL) <> NotAppl THEN
			 errmsg("VIV-ERR404, Pág. X, Situación cuestionario = 3 -> Total MIEMBROS = BLANCO"); // 200727  // R200429
			 errmsg("SITUACION: %d, Total Personas: %d", (SITU), (TOTAL));
			 errmsg("  ");
		  ENDIF;
	  
		ENDIF;
			  
			//-------------------------------------------------------------------------------------------------------------------------
			// CONTROL DE NÚMERO DE LÍNEA REGISTRO DE POBLACIÓN    
			//-------------------------------------------------------------------------------------------------------------------------

			CERAR_POB();

			L = 0; 
			J = 0;
			N = 0;

			DO VARYING N = 1 while N <= 35
			  ctrper(N,1) = 0;
			  ctrper(N,2) = 0;
			  ctrper(N,3) = 0;
			  ctrper(N,4) = 0;
			ENDDO;
			DO VARYING J = 1 while J <= count(REG_GENERAL)

			  PERSONA = (L02(J));
			  DUPL    = 0;

			  IF ctrper(PERSONA,1) = 0 THEN
				 ctrper(PERSONA,1) = (L02(J));
				 ctrper(PERSONA,2) = (LP103(J));
				 ctrper(PERSONA,3) = (LP102(J));      
				 ctrper(PERSONA,4) = (GM101(J));
			  ELSE 
				 ////CONTROLA();
				 errmsg("POB-ERR001X, Número de persona Duplicado en Características de Pobl.");
				 errmsg("Línea Pers. guardada: %02d, Edad guardada: %3d, P2 guard.: %d, P3 guard.: %d",
								  ctrper(PERSONA,1), ctrper(PERSONA,2), ctrper(PERSONA,3), ctrper(PERSONA,4));
				 errmsg("PERSONA: %02d, EDAD: %3d, Parentesco: %d, P3: %d",
						 PERSONA,       (LP103(J)),   (LP102(J)),  (GM101(J)));
				 errmsg("  ");
				 DUPL = 1;
			  ENDIF;
				 
			ENDDO; 

			N = 0;

			DO VARYING N = 1 WHILE N <= count (REG_GENERAL)

			  IF (L02(N)) <> N THEN 
				 IF DUPL = 0 THEN
					////CONTROLA();
					errmsg("POB-ERR001AX, Número de LINEA de las personas FUERA de Secuencia.");
					errmsg("Contador Líneas: %02d, LP11 [Nº Persona]: %02d, EDAD: %3d, Parentesco: %d, P103: %d",
											 N,            (L02(N)),         (LP103(N)),    (LP102(N)),  (GM101(N)));
					errmsg("  ");
				 ENDIF;
			  ENDIF;
			ENDDO;  


		//----------------------------------------------------------------------------------------------------------------

//#endfor;
PROC XVAL02
	IF (SITU) IN 1,2 and (PL02) = 1 THEN

		Persona = (PL02);
			

//****************************************Correo electrónico****************************************************************	
		VALIDAR_CORREO(strip(P101),"P101");

		IF strip(P101) = "" THEN				
		 ////CONTROLA();
		 errmsg("POST-ERR01, Si PARENTESCO PL02 = 1 -> Controlar Correo electrónico P101 ");
		 errmsg("Módulo Postulante");			
		 errmsg("Postulante: %02d, EDAD: %3d, P101 Correo electrónico : %s", Persona, (LP103(1)), STRIP(P101));
		 errmsg("  ");                        
		ENDIF;
		
//*********************************************************Nº de TELEFONO************************************************************
	
	    IF STRIP(P102) = "" THEN     // BBB ABRE
	      //CONTROLA();
	      errmsg("POST-ERR02, Nº de TELEFONO [%s] en BLANCO", P102);
		  errmsg("Postulante: %02d, EDAD: %3d, P102 Número de teléfono : %s", Persona, (LP103(1)), STRIP(P102));
	      errmsg("  ");
	    ENDIF;
	   
	   // R200422 ABRE AGREGAR
	   IF STRIP(P102) <> "" THEN
	      IF STRIP(P102) = "N/T" OR STRIP(P102) = "N/D" THEN
		  ELSE
             IF length(strip(P102)) < 5 THEN
                errmsg("POST-ERR02.1, VER Nº de TELEFONO [%s]", P102);
                errmsg("    Distinto a N/T ó N/D ó Longitud menor a 5 dígitos");
				errmsg("  ");
			 ENDIF;
          ENDIF;
       ENDIF;	  
	
//************************************¿Vive en este lugar hace más de tres años?****************************************	

	   IF NOT (P103) IN 1,6 THEN  
		  //CONTROLA();
		  errmsg("POST-ERR03, ¿Vive en este lugar hace más de tres años? [%d] <> 1,6", (P103)); 
		  errmsg("  ");
	   ENDIF;
	   
	   IF (P103) IN 1 and (P104) <> notappl THEN
		 //CONTROLA();
		 errmsg("POST-ERR03.1, ¿Vive en este lugar hace más de tres años? P103 = 1 [%d] -> P104 <> BLANCO [%d]", (P103), (P104)); 
		 errmsg("  ");
	   ENDIF;

 
//***************¿Hace cuanto tiempo vive en este lugar?***************************************************	
	  IF  (P103) IN 6 THEN 
		  IF  (P104A) in notappl then
			 ////CONTROLA();
			 errmsg("POST-ERR04, Cantidad de Años <>  0:100,999");
			 errmsg("Módulo Postulante");			
			 errmsg("Postulante: %02d, EDAD: %3d, P104A : %03D", Persona, (LP103(1)), (P104A));
			 errmsg("  ");
		  ENDIF;
	
 	  
		  IF not (P104M) in 00:11, 99 then
			 //errmsg("018- pasó por lista personas");
			 ////CONTROLA();
			 errmsg("POST-ERR04.1, Cantidad de Años <> 0:11 NR");
			 errmsg("Módulo Postulante");			
			 errmsg("Postulante: %02d, EDAD: %3d, P104M : %02D", Persona, (LP103(1)), (P104M));
			 errmsg("  ");
		  ENDIF;
	ENDIF;

//***********************¿Este será tu lugar de residencia permanente?************************************************	

	   IF NOT (P105) IN 1,6,99 THEN  
		  //CONTROLA();
		  errmsg("POST-ERR05, ¿Este será tu lugar de residencia permanente? P105 [%d] <> 1,6 NR", (P105)); 
		  errmsg("  ");
	   ENDIF;
	   
	   IF (P105) IN 1 and (P106_DPTO) and (P106_DISTV) <> notappl THEN
		 //CONTROLA();
		 errmsg("POST-ERR05.1, ¿Este será tu lugar de residencia permanente? P105= 1 [%d] -> P106_DPTO [%d] y P106_DISTV <> BLANCO [%d]", (P105), (P106_DPTO), (P106_DISTV)); 
		 errmsg("  ");
	   ENDIF;
	
//*******************¿Qué departamento y distrito será tu lugar de residencia permanente?**********************************************	
	IF  (P105) IN 6 THEN 
	   IF (P106_DPTO) IN NOTAPPL then
		 errmsg("POST-ERR06, ¿Qué departamento y distrito será tu lugar de residencia permanente? -> P106DPTO Departamento <> 0:17,99");
		 errmsg("Módulo Postulante");			
		 errmsg("Postulante: %02d, EDAD: %3d, P106DPTO : %02D", Persona, (LP103(1)), (P106_DPTO) );
		 errmsg("  ");
	   ENDIF;

	   IF (P106_DISTV) in notappl then
		 errmsg("POST-ERR06.1, ¿Qué departamento y distrito será tu lugar de residencia permanente? -> P106DISTV Distrito = Blanco ");
		 errmsg("Módulo Postulante");			
		 errmsg("Postulante: %02d, EDAD: %3d, P106DISTV : %04D", Persona, (LP103(1)), (P106_DISTV) );
		 errmsg("  ");
	   ENDIF;
	ENDIF;
//**************************¿Pertenece a alguna comunidad indígena?**************************************************	

	   IF NOT (P107) IN 1,6,99 THEN  
		  //CONTROLA();
		  errmsg("POST-ERR07, ¿Pertenece a alguna comunidad indígena? P107 [%d] <> 1,6 NR", (P107)); 
		  errmsg("  ");
	   ENDIF;
	   
	   IF (P107) IN 6 and (P108) <> notappl and STRIP(P108E) <> "" THEN
		 //CONTROLA();
		 errmsg("POST-ERR07.1, ¿Pertenece a alguna comunidad indígena? P107 = 6 [%d] -> P108 <> BLANCO [%d] y P108E <> BLANCO [%S]",(P107), (P108), STRIP(P108E)); 
		 errmsg("  ");
	   ENDIF;
	   
//*****************************¿A que comunidad perteneces?***********************************************************	
	IF  (P107) IN 1 THEN 
	   IF not (P108) in 1:8,99 THEN
			 ////CONTROLA();
			 errmsg("POST-ERR08, ¿A que comunidad perteneces? P108 [%d] <> 1:8 NR", (P108));
			 errmsg("Módulo Postulante");			
			 errmsg("Postulante: %02d, EDAD: %3d, P108 : %d", Persona, (LP103(1)), (P108) );
			 errmsg("  ");
	   ENDIF;
	  
	   IF (P108) in 8 AND STRIP(P108E) = "" THEN        // JJJ        
		     //CONTROLA();
			 errmsg("POST-ERR08.1, Si P108 = 8 -> Especifique en BLANCO");   // JJJ
			 errmsg("Módulo Postulante");			
			 errmsg("Postulante: %02d, P108: %2d, P108E : %s", Persona, (P108), STRIP(P108E) );
			 errmsg("  ");
	   ENDIF;
		   
	   IF  (P108) in 1:7 AND not strip(P108E) = "" THEN
		//CONTROLA();
		  errmsg("POST-ERR08.2, P108 = %d -> Especifique <> BLANCO", (P108));
		  errmsg("Módulo Postulante");			
		  errmsg("   Especifique = %s", P108E);
		  errmsg("  ");
	   ENDIF;
	 ENDIF; 
	  
//******************************¿En los últimos 12 meses, ¿viajaste fuera del País?*******************************	
	
	   IF NOT (P109) IN 1,6,99 THEN  
		  //CONTROLA();
		  errmsg("POST-ERR09, ¿En los últimos 12 meses, ¿viajaste fuera del País? P109 [%d] <> 1,6 NR", (P109)); 
		  errmsg("  ");
	   ENDIF;
	   {
	   IF (P109) IN 6 and (P110) <> notappl or STRIP(P110E) <> "" THEN
		 //CONTROLA();
		 errmsg("POST-ERR09.1, ¿En los últimos 12 meses, ¿viajaste fuera del País? P109 = 6 [%d] -> P110 <> BLANCO [%d] y P110E <> BLANCO [%S]",(P109), (P110), STRIP(P110E)); 
		 errmsg("  ");
	   ENDIF;
   }
//*****************************¿Cuál fue el motivo del viaje?****************************************************	
	
	IF  (P109) IN 1 THEN 
	   IF not (P110) in 1:6,99 THEN
			 ////CONTROLA();
			 errmsg("POST-ERR10, ¿Cuál fue el motivo del viaje? P110 [%d] <> 1:6 NR", (P110));
			 errmsg("Módulo Postulante");			
			 errmsg("Postulante: %02d, EDAD: %3d, P110 : %2D", Persona, (LP103(1)), (P110) );
			 errmsg("  ");
	   ENDIF;
	  
	   IF (P110) in 6 AND STRIP(P110E) = "" THEN        // JJJ        
		     //CONTROLA();
			 errmsg("POST-ERR10.1, Si P108 = 8 -> Especifique en BLANCO");   // JJJ
			 errmsg("Módulo Postulante");			
			 errmsg("Postulante: %02d, P110: %2d, P110E : %s", Persona, (P110), STRIP(P110E) );
			 errmsg("  ");
	   ENDIF;
		   
	   IF  (P110) in 1:5 AND not strip(P110E) = "" THEN
		  //CONTROLA();
		  errmsg("POST-ERR10.2, P108 = %d -> Especifique <> BLANCO", (P110));
		  errmsg("Módulo Postulante");			
		  errmsg("   Especifique = %s", P110E);
		  errmsg("  ");
	   ENDIF;
	ENDIF;
	
//***************************************************************************************************************************	
{	  
	  IF  (LP102(1)) in 2 AND (P112) <> NOTAPPL THEN
		  //CONTROLA();
		  errmsg("POST-ERR11, Parentesco LP102 = %d -> ¿Porqué no vive con su Papá? P112 %d <> BLANCO", (LP102(1)), (P112));
		  errmsg("Módulo Postulante");			
		  errmsg("Postulante: %02d, LP102 : %2D, P112 : %2D", Persona, (LP102(1)), (P112));
		  errmsg("  ");
	  ENDIF;

	  IF  (LP102(1)) in 3 AND (P113) <> NOTAPPL THEN
		  //CONTROLA();
		  errmsg("POST-ERR11.1, Parentesco LP102 = %d -> ¿Porqué no vive con su Mamá? P113 %d <> BLANCO", (LP102(1)), (P113));
		  errmsg("Módulo Postulante");			
		  errmsg("Postulante: %02d, LP102 : %2D, P113 : %2D", Persona, (LP102(1)), (P113));
		  errmsg("  ");
	  ENDIF;
 }

//*****************************¿Porqué no vive con su Papá?****************************************************	
	
	IF  (LP102(1)) in 2 THEN
	   IF not (P112) in 1:5,99 THEN
			 ////CONTROLA();
			 errmsg("POST-ERR12, ¿Porqué no vive con su Papá? P112 [%d] <> 1:5 NR", (P112));
			 errmsg("Módulo Postulante");			
			 errmsg("Postulante: %02d, EDAD: %3d, P112 : %2D", Persona, (LP103(1)), (P112) );
			 errmsg("  ");
	   ENDIF;
	  
	   IF (P112) in 5 AND STRIP(P112E) = "" THEN        // JJJ        
		     //CONTROLA();
			 errmsg("POST-ERR12.1, Si P112 = 5 -> Especifique en BLANCO");   // JJJ
			 errmsg("Módulo Postulante");			
			 errmsg("Postulante: %02d, P112: %2d, P112E : %s", Persona, (P112), STRIP(P112E) );
			 errmsg("  ");
	   ENDIF;
		   
	   IF  (P112) in 1:7 AND not strip(P112E) = "" THEN
		//CONTROLA();
		  errmsg("POST-ERR12.2, P112 = %d -> Especifique <> BLANCO", (P112));
		  errmsg("Módulo Postulante");			
		  errmsg("   Especifique = %s", P112E);
		  errmsg("  ");
	   ENDIF;
	ENDIF;
	
//*****************************¿Porqué no vive con su Mamá?****************************************************	
	
	IF  (LP102(1)) in 3 THEN
	   IF not (P113) in 1:5,99 THEN
			 ////CONTROLA();
			 errmsg("POST-ERR13, ¿Porqué no vive con su Mamá? P113 [%d] <> 1:5 NR", (P113));
			 errmsg("Módulo Postulante");			
			 errmsg("Postulante: %02d, EDAD: %3d, P113 : %2D", Persona, (LP103(1)), (P113) );
			 errmsg("  ");
	   ENDIF;
	  
	   IF (P113) in 5 AND STRIP(P113E) = "" THEN        // JJJ        
		     //CONTROLA();
			 errmsg("POST-ERR13.1, Si P113 = 5 -> Especifique en BLANCO");   // JJJ
			 errmsg("Módulo Postulante");			
			 errmsg("Postulante: %02d, P113: %2d, P113E : %s", Persona, (P113), STRIP(P113E) );
			 errmsg("  ");
	   ENDIF;
		   
	   IF  (P113) in 1:7,99 AND not strip(P113E) = "" THEN
		//CONTROLA();
		  errmsg("POST-ERR13.2, P113 = %d -> Especifique <> BLANCO", (P113));
		  errmsg("Módulo Postulante");			
		  errmsg("   Especifique = %s", P113E);
		  errmsg("  ");
	   ENDIF;
	ENDIF;
	
 //**************************En este hogar, ¿a quién consideran como jefe/a del hogar?**************************************************	
	 
		IF (P114) = NotAppl THEN
			////CONTROLA();
			errmsg("POST-ERR14, Hogar sin Jefe P114  = BLANCO");			
			errmsg("Módulo Postulante");						
			errmsg("PERSONA: %02d, EDAD: %3v, P114: %v",
				  PERSONA,       (LP103(1)),   (P114) );
			errmsg("Es miembro: %d,",(GM101(1)) );	  
			errmsg("  ");
		else
			numeric busk_jefe;
			busk_jefe = count(REG_GENERAL where L02 in (P114) and GM101 in 1);
			
			if busk_jefe in 0 then
				errmsg("POST-ERR14.1, P114. Jefe, no está registrado en la Lista de personas miembros del hogar");	
				errmsg("Módulo Postulante");							
				errmsg("PERSONA: %02d, EDAD: %3v, P114: %v",
					  PERSONA,       (LP103(1)),   (LP103(1)) );
				errmsg("Es miembro: %d,",(GM101(1)) );	  
				errmsg("  ");
			endif;
			
			if busk_jefe in 1 then
				if (LP103((P114))) < 15  then
					errmsg("POST-ERR14.2, P114. es el jefe de Hogar y su edad es menor a 15 años");	
					errmsg("Módulo Postulante");		
					errmsg("PERSONA: %02d, EDAD: %3v, P114: %v",
						  PERSONA,       (LP103(1)),   (LP103(1)) );
					errmsg("Es miembro: %d,",(GM101(1)) );	  
					errmsg("  ");
				endif;

				if (LP102((P114))) in 11 then
					errmsg("POST-ERR14.3, P114. jefe, tiene Parentesco = 11");			
					errmsg("Módulo Postulante");					
					errmsg("PERSONA: %02d, EDAD: %3v, P114: %v",
						  PERSONA,       (LP103(1)),   (P114) );
					errmsg("Es miembro: %d,",(GM101(1)) );	  
					errmsg("  ");
				endif;
			endif;
		
		ENDIF; //fin 

	

//***************************************En este hogar, ¿algún miembro recibe beneficios de los programas del estado como...**********************************	
		
		IF ischecked("1236", strip(P115)) in notappl then
		  
				 ////CONTROLA();
				 errmsg("POST-ERR15, En este hogar, ¿algún miembro recibe beneficios de los programas del estado como... P115 [%s] = Blanco ", strip(P115));
				 errmsg("Módulo Postulante");			
				 errmsg("Postulante: %02d, EDAD: %3d, P115 : %s", Persona, (LP103(1)), strip(P115) );
				 errmsg("  ");
		 ENDIF;
	   
			{IF ischecked("6", strip(P115)) AND ischecked("12399", strip(P115)) then
				//CONTROLA();
				errmsg("POST-ERR16.1, P115 = %s -> SI TIENE MARCADO LA OPCION 6 NO DEBE TENER OTRA OPCIÓN");
				errmsg("Módulo Postulante");    
				errmsg("Postulante: %02d, P115: %s, P1151 : %d ", Persona, strip(P115(1)), ischecked("12399", strip(P115)) );
				errmsg(" ");
			ENDIF;
			
			IF ischecked("99", strip(P115)) AND ischecked("1236", strip(P115)) then
				//CONTROLA();
				errmsg("POST-ERR16.2, P115 = NR -> SI TIENE MARCADO LA OPCION NR NO DEBE TENER OTRA OPCIÓN");
				errmsg("Módulo Postulante ");   
				errmsg("Postulante: %02d, P115: %2d, P1151 : %s(VERIFICAR NO REPORTA EN LA PRIMERA OPCIÓN)", Persona, (P115(1)),ischecked("1236", strip(P115)) );	
				errmsg("------------------");
				errmsg(" ");
			ENDIF;
}
			IF ischecked("3", strip(P115)) then
				IF STRIP(P115E) IN "" THEN
					//CONTROLA();
					errmsg("POST-ERR16.1, P115 = 3 -> Especifique = BLANCO");
					errmsg("Módulo Postulante");    
					errmsg("Postulante: %02d, P115: %s, P115E : %s (espificar debe tener datos)", Persona, STRIP(P115), STRIP(P115E) );
					errmsg(" ");
				ENDIF;
			ELSE
			
			IF NOT STRIP(P115E) IN "" THEN
				//CONTROLA();
				errmsg("POST-ERR16.2, P115 <> 3  -> P115E (especificar) <> BLANCO");
				errmsg("Módulo Postulante ");   
				errmsg("Postulante: %02d, P115: %s, P115E : %s(espificar NO debe tener datos)", Persona, STRIP(P115), STRIP(P115E) );		
				errmsg("------------------");
				errmsg(" ");
			ENDIF;
			

			
//*************************************Registre el número de línea del/los beneficiario/os******************************************	
	//IF COUNT (REG_GENERAL) > 0 and SITU in 1,2 THEN
	 
		DO varying i = 1 while i <= COUNT (REG_BENEFICIARIOS)
		
			IF ischecked("6", strip(P115)) then
				IF not (P116(i)) = notappl THEN
				 ////CONTROLA();
				 errmsg("POST-ERR17, Si P115 = 6 -> Registre el número de línea del/los beneficiario/os P1161 <> BLANCO");
				 errmsg("Módulo Postulante");			
				 errmsg("Postulante: %02d, P115 : %s, P116: %d", Persona, strip(P115), (P116(i)));
				 errmsg("  ");                        
				ENDIF;
		
			endif;

		ENDDO;
	endif;
	//**********ENDDO X***** //tercera parte
//----------------------------------------------------------------------------------------------------------------
        //*IF TOTOcc(REG_GENERAL_EDT) > 0 and SITU in 1,2 THEN 
		IF COUNT(REG_GENERAL) > 0 and SITU in 1,2 THEN
		//**errmsg("002- pasó por lista personas");
		
			numeric CUENTAJ, CUENTA1, CUENTAC, LINJ, LINC, DIFE;
			numeric PER, Postulante;	
			
			CUENTAJ = COUNT(REG_GENERAL WHERE GM101 = 1 AND LP102 = 1);      
				  
			IF CUENTAJ = 0 THEN
			   errmsg("ERROR020.  NO se registra POSTULANTE EN EL HOGAR [%02d]", CUENTA1);
			   errmsg("Módulo Postulante");
			   errmsg("  ");
			ENDIF;

			IF CUENTAJ > 1 THEN
			   errmsg("ERROR021.  Se registra más de 1 POSTULANTE EN EL HOGAR [%02d]", CUENTA1);
			   errmsg("Módulo Postulante");
			   errmsg("  ");
			ENDIF;

			EDADJ = 0;

		endif;
		
//----------------------------------------------------------------------------------------------------------------
	ENDIF;
PROC XVAL03

//------------------------------------------------------------------------------------
//CONTROL POBLACION
//------------------------------------------------------------------------------------
	IF COUNT (REG_GENERAL) > 0 and SITU in 1,2 THEN
	 
		DO varying i = 1 while i <= COUNT (REG_GENERAL)

			Persona = (L02(i));
			
			 
//******************************************PARENTESCO***************************************************************************************		  			  
		  
		  IF not (LP102(i)) IN 1:11 THEN
			  ////CONTROLA();
			  errmsg("POB-ERR002, P102 Parentesco <> 1:11");
			  errmsg("Lista de Personas");
			  errmsg("PERSONA: %02d,  P102: %d",
					  PERSONA, (LP102(i)));
			  errmsg("  ");
		   ENDIF;

	
//**********************************¿ES MIEMBRO DEL HOGAR?*******************************************************************************

		IF not (GM101(i)) <> NotAppl then
			 ////CONTROLA();
			 errmsg("POB-ERR101, Es miembro del Hogar? GM101 ->  <> 1 , 6");
			 errmsg("PERSONA: %02d,  MIEMBRO GM101: %D", PERSONA, (GM101(i)));      
			 errmsg("  ");
		ENDIF;
		

		IF (GM101(i)) = 6 then 
			IF LP103(i) <> NotAppl OR GM103D(i) <> NotAppl OR GM103M(i) <> NotAppl 
				OR GM103A(i) <> NotAppl OR GM104(i)  <> NotAppl then
				////CONTROLA();
				errmsg("POB-ERR102, NO MIEMBRO CON DATOS EN LP103, GM103D, GM103M,GM103A,GM104");
				errmsg("PERSONA: %02d, GM101: %d, LP103: %3d, GM103D: %02d, GM103M: %02d, GM103A: %04d, GM104: %d",
							PERSONA, GM101(i), LP103(i),  GM103D(i),    GM103M(i),    GM103A(i),    GM104(i));      
				errmsg("------------------");
				errmsg(" ");
			ENDIF;
		ENDIF;

//*************************¿En qué fecha nació  …[NOMBRE]... ?*******************************************************************************
	IF (GM101(i)) IN 1 THEN
		IF not (GM103D(i)) IN 1:31, 99 then
			 ////CONTROLA();
			 errmsg("POB-ERR104, PERSONA MIEMBRO -> GM103D Día = 1:31 NR");
			 errmsg("Lista de Personas");
			 errmsg("PERSONA: %02d, Parentesco: %D,  Día: %02D", PERSONA, (LP102(i)), (GM103D(i)) );
			 errmsg("  ");
		ENDIF;
		  
		IF not (GM103M(i)) in 1:12, 99 then
			 //errmsg("018- pasó por lista personas");
			 ////CONTROLA();
			 errmsg("POB-ERR105, PERSONA MIEMBRO -> GM103M Mes = 1:12 NR");
			 errmsg("Módulo Población");
			 errmsg("PERSONA: %02d,  Parentesco: %D,  Mes: %02D", PERSONA, (LP102(i)), (GM103M(i)) );
			 errmsg("  ");
		ENDIF;


		  IF not (GM103A(i)) in 1890:2022 then
			 ////CONTROLA();
			 errmsg("POB-ERR106, PERSONA MIEMBRO -> GM103A Año = 1890:2021");
			 errmsg("Módulo Población");
			 errmsg("PERSONA: %02d,   Parentesco: %D,  Año: %04D", PERSONA, (LP102(i)), (GM103A(i)) );
			 errmsg("  ");
		  ENDIF;

//*************************************************************************************************************
		 IF  (GM103D(i))  = 31 then
			IF not (GM103M(i)) in 1,3,5,7,8,10,12 THEN
			   ////CONTROLA();
			   errmsg("POB-ERR107,  GM103D.Día = 31 y GM103M.Mes <> 1 3 5 7 8 10 12");
			   errmsg("Módulo Población");
			   errmsg("PERSONA: %02d, Día: %02d, Mes: %02d,", PERSONA, (GM103D(i)), (GM103M(i)) ) ;
			   errmsg("  ");
			ENDIF;
		 ENDIF;
	         
		 IF (GM103M(i)) = 2 then
			ANHOBIS  = 0;            
			ANHOBIS = ( (GM103A(i)) / 4);
			BISIES  = ( (GM103A(i)) - (ANHOBIS * 4));
		  
			IF NOT (GM103D(i)) IN 1:29, 99 then
			   ////CONTROLA();
			   errmsg("POB-ERR108,  P105.Día <> (1:29, NR) para mes = 2 ");
			   errmsg("Módulo Población");
			   errmsg("PERSONA: %02d,  Mes: %02d,  Día %02d,  Año: %04d",
					   PERSONA,        (GM103M(i)),     (GM103D(i)),   (GM103A(i)) );
			   errmsg("  ");
			ENDIF;
			
			IF (GM103D(i)) = 29 THEN
			   IF BISIES <> 0 THEN
				  ////CONTROLA();
				  errmsg("POB-ERR109,  GM103D.día = 29 para mes = 2 y año no bisiesto");
				  errmsg("Módulo Población");
				  errmsg("PERSONA: %02d, GM103M: %02d, GM103D %02d, GM103A: %04d, Cálculo: %05.2F",
						  PERSONA,       (GM103M(i)),    (GM103D(i)),   (GM103A(i)),    ANHOBIS);
				  errmsg("  ");
			   ENDIF;
			ENDIF;  
		ENDIF; 
			 
			 
			 XEDAD   = 0;
	
	        IF (GM103A(i)) <> 9999 AND (GM103M(i)) <> 99 AND (GM103D(i)) <> 99 then
				   MDE = (FVM(1))  * 100 + (FVD(1));
	               MDN = ((GM103M(i)) * 100) + (GM103D(i));
			ENDIF;
			IF (GM103A(i)) <> 9999 AND (GM103M(i)) <> 99 AND (GM103D(i)) = 99 then      
			   MDE = (FVM(1))  * 100;
			   MDN = (GM103M(i)) * 100;
			ENDIF;
		 
			IF (GM103A(i)) <> 9999 AND (GM103A(i)) <> NotAppl AND 
			   (GM103M(i)) <> 99   AND (GM103M(i)) <> Notappl AND 
			   (GM103D(i)) <> 99   AND (GM103D(i)) <> NotAppl THEN
		 
			   DN = (GM103D(i));
	  
			   IF (GM103M(i)) = 2 AND (GM103D(i)) = 29 then
				  DN = 28;
			   ENDIF;
	  
			   IF (GM103A(i)) > (FVA(1)) then
				  ////CONTROLA();
				  errmsg("POB-ERR111,  Fecha de nacimiento posterior a fecha 1a. visita");
				  errmsg("Módulo Población");
				  errmsg("Persona: %2d, Fecha de nacimiento: %02d/%02d/%04d posterior,", 
				  PERSONA, (GM103D(i)), (GM103M(i)), (GM103D(i)) );
				  errmsg("            Fecha de 1a. visita: %02d/%02d/%04d",   
				  (FVD(1)), (FVM(1)), (FVA(1))  );
				  errmsg("  ");
			   ENDIF;
			
			   IF (GM103A(i)) = (FVA(1)) then
				  IF (FVM(1)) < (GM103M(i)) then
						 ////CONTROLA();
						errmsg("POB-ERR112,  Mes de 1a. visita es menor al mes de nacimiento");
						errmsg("Módulo Población");
						errmsg("Persona: %2d, Fecha de nacimiento: %02d/%02d/%04d posterior,", 
						PERSONA, (GM103D(i)), (GM103M(i)), (GM103A(i)) );
						errmsg("          Fecha de 1a. visita: %02d/%02d/%04d",   
						(FVD(1)), (FVM(1)), (FVA(1))  );
						errmsg("  ");
				  ENDIF;
			
				  IF (FVM(1)) = (GM103M(i)) AND (FVD(1)) < (GM103D(i)) then
					 ////CONTROLA();
						errmsg("POB-ERR113,  Día 1a. visita es menor al día de nacimiento");
						errmsg("Módulo Población");
						errmsg("Persona: %2d, Fecha de nacimiento: %02d/%02d/%04d posterior,", 
						PERSONA, (GM103D(i)), (GM103M(i)), (GM103A(i)) );
						errmsg("            Fecha de 1a. visita: %02d/%02d/%04d",   
						(FVD(1)), (FVM(1)), (FVA(1))  );
						errmsg("  ");
				  ENDIF;
			   ENDIF;
		 
			   XEDAD = 0;   
			   IF (FVA(1)) > (GM103A(i)) then
				  IF MDE >= MDN then
					 XEDAD = (FVA(1)) - (GM103A(i));
				  ELSE
					 XEDAD = (FVA(1)) - (GM103A(i)) - 1;
				  ENDIF;
			   ENDIF;
			
			   IF (LP103(i)) <> XEDAD then
				  ////CONTROLA();
				  errmsg("POB-ERR114,  Edad no se corresponde con cálculo de Edad");
				  errmsg("Módulo Población");
				  errmsg("PERSONA: %02d, Fecha de nacimiento: %02d/%02d/%04d, Edad       : %03D", PERSONA, (GM103D(i)), (GM103M(i)), (GM103A(i)), (LP103(i)) );
				  errmsg("               Fecha de 1a. visita: %02d/%02d/%04d, Cálculo de Edad: %03D", (FVD(1)), (FVM(1)), (FVA(1)), XEDAD);
				  errmsg("  ");
			   ENDIF;
		ENDIF;
	  
			IF (GM103M(i)) = 99 AND (GM103A(i)) <> 9999 THEN
			   IF (GM103A(i)) > (FVA(1)) THEN
				  ////CONTROLA();
				  errmsg("POB-ERR115,  Fecha de nacimiento posterior a fecha de 1a. visita");
				  errmsg("Módulo Población");
				  errmsg("PERSONA: %02d, Fecha de nacimiento: %02d/%02d/%04d,", PERSONA, (GM103D(i)), (GM103M(i)), (GM103A(i)) );
				  errmsg("               Fecha de 1a. visita: %02d/%02d/%04d",  (FVD(1)), (FVM(1)), (FVA(1)) );
				  errmsg("  ");
			   ENDIF;
		
			   IF (FVA(1)) > (GM103A(i)) then
				  XEDAD = (FVA(1)) - (GM103A(i));
			   ENDIF;
		 
			   IF (LP103(i)) <> XEDAD then
				  ////CONTROLA();
				  errmsg("POB-ERR116,  Edad no se corresponde con cálculo de Edad");
				  errmsg("Módulo Población");
				  errmsg("PERSONA: %02d, Fecha de nacimiento: %02d/%02d/%04d, Edad       : %03D", PERSONA, (GM103D(i)), (GM103M(i)), (GM103A(i)), (LP103(i)) );
				  errmsg("               Fecha de 1a. visita: %02d/%02d/%04d, Cálculo de Edad: %03D",  (FVD(1)), (FVM(1)), (FVA(1)) , XEDAD);
				  errmsg("  ");
				  errmsg("  ");
			   ENDIF;
			ENDIF;
	  
			IF (GM103A(i)) <> 9999 AND (GM103M(i)) <> 99 AND (GM103A(i)) = 99 then
			  { IF (S3_P6A(i)) > (ANIO2) then
				  ////CONTROLA();
				  errmsg("POB-ERR050,  Fecha de nacimiento posterior a fecha de 1a. visita");
				  errmsg("PERSONA: %02d, Fecha de nacimiento: %02d/%02d/%04d,", PERSONA, (S3_P6D(i)), (S3_P6M(i)), (S3_P6A(i)));
				  errmsg("             Fecha de 1a. visita: %02d/%02d/%04d",  (DIA), (MES), (ANO));
				  errmsg("  ");                  
			   ENDIF;
		 
			   IF (ANIO2) > (S3_P6A(i)) then
				  IF MDE >= MDN then
					 XEDAD = (ANO) - (S3_P6A(i));
				  ELSE
					 XEDAD = (ANO) - (S3_P6A(i)) - 1;
				  ENDIF;
			   ENDIF;
		 
			   IF (EDAD02(i)) <> XEDAD then
				  ////CONTROLA();
				  errmsg("POB-ERR051,  Edad no se corresponde con cálculo de Edad");
				  errmsg("PERSONA: %02d,  Fecha de nacimiento: %02d/%02d/%04d, EDAD: %3D", PERSONA, (S3_P6D(i)), (S3_P6M(i)), (S3_P6A(i)), (EDAD02(i)));
				  errmsg("              Fecha de 1a. visita: %02d/%02d/%04d, Cálculo de EDAD: %3D", (DIA), (MES), (ANO), XEDAD);
				  errmsg("  ");
			   ENDIF;}
	  
			ENDIF;

//***************************************************** Género *******************************************************************************

	   
	   IF not (GM104(i)) in 1:4, 99 THEN
			//CONTROLA();
			   errmsg("POB-ERR117, GM104 Género fuera de rango, GM104 = 1:4, NR");
			   errmsg("Módulo Población");	
			   errmsg("PERSONA: %02d, EDAD: %03d", PERSONA, (LP103(PERSONA)));
			   errmsg("Es miembro?       : %d", (GM101(PERSONA)));
			   errmsg("GM104. Genero  : %d", (GM104(i)));
			   errmsg("  ");
		ENDIF;
			
		IF (GM104(i)) in 3 AND STRIP(GM104E(i)) = "" THEN        // JJJ        
		     //CONTROLA();
			 errmsg("POB-ERR117.1, Si GM104 = 3 -> Especifique en BLANCO");   // JJJ
			 errmsg("Módulo Población");			
			 errmsg("PERSONA: %02d, GM104: %2d, GM104E : %s", PERSONA, (GM104(i)), STRIP(GM104E(i)) );
			 errmsg("  ");
	   ENDIF;
		   
	   IF  (GM104(i)) in 1,2,4 AND not strip(GM104E(i)) = "" THEN
			//CONTROLA();
			  errmsg("POB-ERR117.2, GM104 = %d -> Especifique <> BLANCO", (GM104(i)));
			  errmsg("Módulo Población");			
			  errmsg("   Especifique = %s", GM104E(i));
			  errmsg("  ");
	   ENDIF;


//***************************************************** ¿Tiene cédula de identidad? *******************************************************************************
			 
		IF not (GM105(i)) in 1,6 , 99 THEN
			//CONTROLA();
			   errmsg("POB-ERR118, GM105 cédula de identidad fuera de rango, GM105 = 1,6, NR");
			   errmsg("Módulo Población");	
			   errmsg("PERSONA: %02d, EDAD: %03d", PERSONA, (LP103(PERSONA)));
			   errmsg("Es miembro?       : %d", (GM101(PERSONA)));
			   errmsg("GM105. Cédula  : %d", (GM105(i)));
			   errmsg("  ");
		ENDIF;
			
			IF (GM105(i)) in 6 THEN
			
				IF strip(GM106(i)) <> "" THEN

				   errmsg("POB-ERR118.1, Si GM105 = 6 -> GM106 = BLANCO");
				   errmsg("Módulo Población");	
				   errmsg("PERSONA: %02d, EDAD: %03d", PERSONA, (LP103(PERSONA)));
				   errmsg("Es miembro?       : %d", (GM101(PERSONA)));
				   errmsg("GM105. Cédula  : %d", (GM105(i)));
				   errmsg("GM106.   : %s", strip(GM106(i)));
				   errmsg("  ");
				ENDIF;

			ENDIF;

//***************************************************** Anote el número de cédula *******************************************************************************
	IF (GM105(i)) in 1 THEN
		IF  strip(GM106(i)) in "" THEN
			//CONTROLA();
			   errmsg("POB-ERR119, GM106 número de cédula, -> GM106 = BLANCO");
			   errmsg("Módulo Población");	
			   errmsg("PERSONA: %02d, EDAD: %03d", PERSONA, (LP103(PERSONA)));
			   errmsg("Es miembro?       : %d", (GM101(PERSONA)));
			   errmsg("GM106. N° Cédula  : %s", strip(GM106(i)));
			   errmsg("  ");
		ENDIF;
	ENDIF;
//***************************************************** ¿Tiene alguna discapacidad? *******************************************************************************

		IF not (GM107(i)) in 1:3,99 THEN
			   //CONTROLA();
			   errmsg("POST-ERR120, ¿Tiene alguna discapacidad? GM107  <> 1:3 NR");
			   errmsg("Módulo Población");	
			   errmsg("PERSONA: %02d, EDAD: %03d", PERSONA, (LP103(PERSONA)));
			   errmsg("Es miembro?       : %d", (GM101(PERSONA)));
			   errmsg("GM107. ¿Tiene alguna discapacidad? : %d", (GM107(i)));
			   errmsg("  ");
		ENDIF;


//***************************************************** ¿Que tipo de discapacidad tiene? *******************************************************************************
		
		IF (GM107(i)) in 3 THEN		
		   IF ischecked("12345", strip(GM108(i))) then
		  // IF not strip(GM108(i)) in "" then
				 ////CONTROLA();
				 errmsg("POST-ERR121, ¿Que tipo de discapacidad tiene? GM108 %s <> Blanco ", strip(GM108(i)));
				 errmsg("Módulo Postulante");			
				 errmsg("PERSONA: %02d, EDAD: %3d, GM108 : %s", PERSONA, (LP103(i)), strip(GM108(i)) );
				 errmsg("  ");
		   ENDIF;
		ENDIF;
			{	IF ischecked("99", strip(GM108(i))) AND ischecked("12345", strip(GM108(i))) then
				//CONTROLA();
				errmsg("POST-ERR121.1, GM108 = NR -> SI TIENE MARCADO LA OPCION NR NO DEBE TENER OTRA OPCIÓN");
				errmsg("Módulo Postulante ");   
				errmsg("PERSONA: %02d, GM108: %s, GM1081 : %s(VERIFICAR NO REPORTA EN LA PRIMERA OPCIÓN)", PERSONA, (GM108(i)),ischecked("12345", strip(GM108(i))) );	
				errmsg("------------------");
				errmsg(" ");
			ENDIF;
			}

			IF ischecked("5", strip(GM108(i))) then
				IF STRIP(GM108E(i)) IN "" THEN
					//CONTROLA();
					errmsg("POST-ERR121.2, GM108 = 5 -> Especifique = BLANCO");
					errmsg("Módulo Postulante");    
					errmsg("PERSONA: %02d, GM108: %s, GM108E : %s (espificar debe tener datos)", PERSONA, strip(GM108(i)), STRIP(GM108E(i)) );
					errmsg(" ");
				ENDIF;
			ELSE
			
			IF NOT STRIP(GM108E(i)) IN "" THEN
				//CONTROLA();
				errmsg("POST-ERR121.3, GM108 <> 5  -> GM108E (especificar) <> BLANCO");
				errmsg("Módulo Postulante ");   
				errmsg("PERSONA: %02d, GM108: %s, GM108E : %s(espificar NO debe tener datos)", PERSONA, strip(GM108(i)), STRIP(GM108E(i)) );		
				errmsg("------------------");
				errmsg(" ");
			ENDIF;
		
				
//***************************************************** ¿Tiene algún tipo de enfermedad? *******************************************************************************
			
			IF not (GM109(i)) in 1:3,99 THEN
				 ////CONTROLA();
				 errmsg("POST-ERR122, ¿Tiene algún tipo de enfermedad? GM109 [%d] <> 1:3 NR", (GM109(i)));
				 errmsg("Módulo Postulante");			
				 errmsg("PERSONA: %02d, EDAD: %3d, GM109 : %d", PERSONA, (LP103(i)), (GM109(i)) );
				 errmsg("  ");
		    ENDIF;
	
		{	IF (GM110(i)) <> NotAppl THEN

			   errmsg("POST-ERR122.1, Si GM109 = 6 y LP103> 12 -> GM110 = BLANCO");
			   errmsg("Módulo Población");	
			   errmsg("PERSONA: %02d, ", PERSONA);
			   errmsg("Es miembro?    : %d", (GM101(PERSONA)));
			   errmsg("GM109  : %d", (GM109(i)));
			   errmsg("EDAD: %03d", (LP103(i)));
			   errmsg("GM110. : %d", (GM110(i)));
			   errmsg("  ");
			ENDIF;
	}
//*******************************************La enfermedad que sufre es...*************************************************************************
		
		IF  (GM109(i)) in 3 THEN	
		    IF  (GM110(i)) in 1:4,99 THEN
				 ////CONTROLA();
				 errmsg("POST-ERR123, La enfermedad que sufre es GM110 [%d] <> 1:4 NR", (GM110(i)));
				 errmsg("Módulo Postulante");			
				 errmsg("PERSONA: %02d, EDAD: %3d, GM110 : %d", PERSONA, (LP103(i)), (GM110(i)) );
				 errmsg("  ");
		    ENDIF;
	
						
			{IF (GM111(i)) <> NotAppl THEN

			   errmsg("POST-ERR123.1, Si GM110 = 1:4 y LP103 > 5 -> GM111 = BLANCO");
			   errmsg("Módulo Población");	
			   errmsg("PERSONA: %02d,EDAD: %03d ", PERSONA,(LP103(i)));
			   errmsg("Es miembro?    : %d", (GM101(PERSONA)));
			   errmsg("GM110  : %d", (GM110(i)));
			   errmsg("GM111. : %d", (GM111(i)));
			   errmsg("  ");
			ENDIF;
		}
		ENDIF;	
		
//*******************************************¿Cuál es el  máximo nivel educativo alcanzado?*************************************************************************
			
		IF (GM109(i)) in 3 and (LP103(i)) in 0:4 THEN
			IF  (GM111(i)) in 0:4,99 THEN
				 ////CONTROLA();
				 errmsg("POST-ERR124, ¿Cuál es el  máximo nivel educativo alcanzado? GM111 [%d] = 0:4 NR", (GM111(i)));
				 errmsg("Módulo Postulante");			
				 errmsg("PERSONA: %02d, EDAD: %3d, GM110 : %d", PERSONA, (LP103(i)), (GM111(i)) );
				 errmsg("  ");
		    ENDIF;
		ENDIF;
			IF (GM111(i)) in 0:4 and (LP103(i)) > 17 THEN
			
				 IF (GM112(i)) 	<> NotAppl or
					(GM113(i))   <> NotAppl or
					(GM114(i))   <> NotAppl THEN

				   errmsg("POST-ERR124.1, Si GM111 = 0:4 y LP103 < 17 -> GM112 y GM113 y GM114 <> BLANCO");
				   errmsg("Módulo Población");	
				   errmsg("PERSONA: %02d,EDAD: %03d ", PERSONA,(LP103(i)));
				   errmsg("Es miembro?    : %d", (GM101(PERSONA)));
				   errmsg("GM111. : %d", (GM111(i)));
				   errmsg("GM112  : %d", (GM112(i)));
				   errmsg("GM113  : %d", (GM113(i)));
				   errmsg("GM114  : %d", (GM114(i)));
				   errmsg("  ");
				ENDIF;
			ENDIF;
		
//*******************************************¿Asiste actualmente a la escuela o colegio?*************************************************************************
		
		IF (GM111(i)) in 0:4 and (LP103(i)) > 17 THEN
			IF  (GM112(i)) in 1,6,99 THEN
				 ////CONTROLA();
				 errmsg("POST-ERR125, ¿Asiste actualmente a la escuela o colegio? GM112 [%d] = 1,6 NR", (GM112(i)));
				 errmsg("Módulo Postulante");			
				 errmsg("PERSONA: %02d, EDAD: %3d, GM112 : %d", PERSONA, (LP103(i)), (GM112(i)) );
				 errmsg("  ");
			ENDIF;
	{
			IF (GM112(i)) in 6 and (LP103(i)) in 05:13 THEN
			
				 IF (GM113(i)) 	<> NotAppl THEN
				 ////CONTROLA();
				   errmsg("POST-ERR125.1, Si GM112 = 6 y LP103 = 05:13 -> GM113  <> BLANCO");
				   errmsg("Módulo Población");	
				   errmsg("PERSONA: %02d,EDAD: %03d ", PERSONA,(LP103(i)));
				   errmsg("Es miembro?    : %d", (GM101(PERSONA)));
				   errmsg("GM112  : %d", (GM112(i)));
				   errmsg("GM113  : %d", (GM113(i)));
				   errmsg("  ");
				ENDIF;
			ENDIF;

			IF (GM112(i)) in 6 and (LP103(i)) in 14:17 THEN
			
				 IF (GM113(i)) 	<> NotAppl or
					(GM114(i))   <> NotAppl THEN
				 ////CONTROLA();
				   errmsg("POST-ERR125.2, Si GM112 = 6 y LP103 = 14:17 -> GM113 y GM114 <> BLANCO");
				   errmsg("Módulo Población");	
				   errmsg("PERSONA: %02d,EDAD: %03d ", PERSONA,(LP103(i)));
				   errmsg("Es miembro?    : %d", (GM101(PERSONA)));
				   errmsg("GM112  : %d", (GM112(i)));
				   errmsg("GM113  : %d", (GM113(i)));
				   errmsg("GM114  : %d", (GM114(i)));
				   errmsg("  ");
				ENDIF;
			ENDIF;}
		ENDIF;
		
//*******************************************¿A qué tipo de institución asiste?*************************************************************************
		
			IF (GM112(i)) in 1 and (LP103(i)) > 17 THEN
				IF not (GM113(i)) in 1:3,99 THEN
					 ////CONTROLA();
					 errmsg("POST-ERR126, ¿A qué tipo de institución asiste? GM113 [%d] <> 1:3 NR", (GM113(i)));
					 errmsg("Módulo Postulante");			
					 errmsg("PERSONA: %02d, EDAD: %3d, GM113 : %d", PERSONA, (LP103(i)), (GM113(i)) );
					 errmsg("  ");
				ENDIF;
	
				
			ENDIF;
		ENDIF;
//*******************************************¿Cuál es el monto de la cuota?*************************************************************************
			
			IF (GM113(i)) in 1 THEN
				 IF (GM114(i)) <> NotAppl and (LP103(i)) > 17 THEN
				 ////CONTROLA();
				   errmsg("POST-ERR126.1, Si GM113 = 1 -> GM114  <> BLANCO");
				   errmsg("Módulo Población");	
				   errmsg("PERSONA: %02d,EDAD: %03d ", PERSONA,(LP103(i)));
				   errmsg("Es miembro?    : %d", (GM101(PERSONA)));
				   errmsg("GM113  : %d", (GM113(i)));
				   errmsg("GM114  : %d", (GM114(i)));
				   errmsg("  ");
				ENDIF;
			ENDIF;
//********************************************************************************************************************************
{	IF (SITU) IN 1,2 THEN
		DO VARYING X = 1 WHILE X <= count(REG_GENERAL) //*******DO X******
			  //*errmsg("001- pasó por lista personas");
			  
			  PERSONA = (L02(X));
			  EDAD    = (LP103(X));

			  IF (L02(X)) = NotAppl THEN
				 //CONTROLA();
				 errmsg("ERR-L001-Lista, Línea de Persona = BLANCO [%d]", (L02(X)));
				 errmsg("  ");
			  ENDIF;

				IF not (L02(X)) = NotAppl THEN
				  IF STRIP(LP101(X)) = "" THEN                                                         
					 //CONTROLA();
					 errmsg("ERR-L002-Lista, Nombre del Censado = BLANCO");
					 errmsg("Lista de Personas");
					 errmsg("PERSONA: %02d, Nombre: %s", (L02(X)), LP101(X));   
					 errmsg("  ");
				  ELSE                                 // R200422 ABRE AGREGAR
					 IF LENGTH(STRIP(LP101(X))) < 10 THEN                                        
						//CONTROLA();
						errmsg("VER-L003-Lista, Nombre del Censado, longitud < 10");
						errmsg("Lista de Personas");
						errmsg("PERSONA: %02d, Nombre: %s", (L02(X)), LP101(X));  
						errmsg("  ");
					 ENDIF;                            // R200422 CIERRA AGREGAR
				  ENDIF;
				  
				IF NOT (LP102(i)) IN 1:11 THEN
					////CONTROLA();
					errmsg("ERR-L004, LP102 Parentesco <> 1:11"); // PARENTESCO FUERA DE RANGO
					errmsg("PERSONA: %02d,  LP102: %d", PERSONA, (LP102(i)));
					errmsg("------------------");
				ENDIF;

		  ENDDO; } //**********ENDDO X***** //segunda parte
		
	ENDIF;

	ENDDO;
ENDIF;	
			
//-------------------------------------------------------------------------------------------------------------------------------------------------
	
PROC XVAL04
//------------------------------------------------------------------------------------
//CONTROL POBLACION
//------------------------------------------------------------------------------------
	IF COUNT (REG_GENERAL) > 0 and SITU in 1,2 THEN

		DO varying i = 1 while i <= COUNT(REG_GENERAL_EDT)

			Persona = (L02(i));
			
		IF (GM101(i)) = 1 AND ((LP103(i)) IN 14:130) THEN	
	
		
//*******************************************¿Trabajó la semana pasada?************************************************************************		
			
		   IF NOT (GM115(i)) IN 1, 6, 99 THEN
			  ////CONTROLA();
			  errmsg("EMP-ERR015,  EDAD = 14:130 999 y  GM115 ¿Trabajó la semana pasada? <> 1 6 NR");
			  errmsg("Módulo Empleo");
			  errmsg("PERSONA: %02d, EDAD: %3d, GM115: %d", PERSONA, (LP103(i)), (GM115(i)));
			  errmsg("  ");
		   ENDIF; 
			 
		   IF (GM115(i)) = 1 then
			  if (GM116(i)) <> NotAppl OR strip(GM116E(i)) <> "" THEN 
				  ////CONTROLA();
				  errmsg("EMP-ERR015.1,  Si GM115 ¿Trabajó la semana pasada? = 1 -> GM116 y GM116E <> BLANCO");
				  errmsg("Módulo Empleo");
				  errmsg("PERSONA: %02d, EDAD: %d, GM115: %d, GM116: %d, GM116E: %S", 
									PERSONA, (LP103(i)), (GM115(i)), (GM116(i)), strip(GM116E(i)) );
				  errmsg("GM116E. Especifique: %v", strip(GM116E(i)) ); 					
				  errmsg("  ");
			  endif;   	
					
			ENDIF;  //fin GM115 = 1 
				
			IF (GM115(i)) = 6 then
				if NOT (GM116(i)) IN 1:13,99 THEN
					  errmsg("EMP-ERR015.2,  Si GM115 ¿Trabajó la semana pasada? = 6 -> GM116 <> 1:13,NR");
					  errmsg("Módulo Empleo");
					  errmsg("PERSONA: %02d, EDAD: %3d, GM115: %d, GM116: %d",
							  PERSONA,       (LP103(i)),  (GM115(i)), (GM116(i)) );
					  errmsg("  ");
				 endif;
			endif;
	
//*******************************************¿La semana pasada...************************************************************************					  
			IF (GM115(i)) = 6 then	  
				if not (GM116(i)) IN 1:13 THEN

					  errmsg("EMP-ERR16,  Si GM115 =6 y GM116 ¿La semana pasada <> 1:13 ");
					  errmsg("Módulo Empleo");
					  errmsg("PERSONA: %02d, EDAD: %3d, GM115: %d, GM116: %d",
							  PERSONA,  (LP103(i)),  (GM115(i)), (GM116(i)));
					  errmsg("GM115: %d", (GM115(i)) ); 			  
					  errmsg("GM116: %d", (GM116(i)) ); 				  
					  errmsg("  ");
				  endif;

			  endif; //fin A309 in 1:7,77 

			 { if (GM116(i)) IN 13 THEN
				  if NOT strip(GM116E(i)) IN "" THEN
					  errmsg("EMP-ERR16.1,  Si GM116 = 13 -> GM116E = Blanco");
					  errmsg("Módulo Empleo");
					  errmsg("PERSONA: %02d, EDAD: %3d, GM116: %d, GM116E: %s",
							  PERSONA,       (LP103(i)),  (GM116(i)), string(GM116E(i)) );
					  errmsg("GM116: %v", (GM116(i)) ); 			  
					  errmsg("GM116E. Especifique: %v", strip(GM116E(i)) ); 	 		  
					  errmsg("  ");
				  endif;

				}	

//*******************************************¿En su trabajo o negocio de la semana pasada, trabajó como...************************************************************		
					  
					  if (GM116(i)) IN 1:6 THEN
						  if (GM117(i)) IN notappl THEN
							  errmsg("EMP-ERR17,  Si GM116 ¿En su trabajo o negocio de la semana pasada, trabajó como = 1:6 -> GM117 <> Blanco");
							  errmsg("Módulo Empleo");
							  errmsg("PERSONA: %02d, EDAD: %3d, GM116: %d, GM117: %d",
									  PERSONA,       (LP103(i)),  (GM116(i)), (GM117(i)) );
							  errmsg("GM116: %v", (GM116(i)) ); 			  
							  errmsg("GM117: %v", (GM117(i)) ); 	 		  
							  errmsg("  ");
						  endif;
				      ENDIF;   //fin 
					  
//*******************************************¿La semana pasada tuvo *****************************************************************************				
					
					if (GM116(i)) IN 1:6 and not (GM117(i)) IN 3:5,8 THEN
					  if (GM118(i)) IN notappl THEN
						  errmsg("EMP-ERR17,  Si GM116 = 1:6 y GM117 <> 3:5,8 -> GM118 ¿La semana pasada tuvo <> Blanco");
						  errmsg("Módulo Empleo");
						  errmsg("PERSONA: %02d, EDAD: %3d, GM116: %d, GM117: %d, GM118: %d",
								  PERSONA,       (LP103(i)), (GM116(i)), (GM117(i)), (GM118(i)) );
						  errmsg("GM116: %v", (GM116(i)) ); 
						  errmsg("GM117: %v", (GM117(i)) ); 			  
						  errmsg("GM118: %v", (GM118(i)) ); 	 		  
						  errmsg("  ");
					  endif;
				    ENDIF;   //fin 
						  
//*******************************************¿A qué  se dedica o produce la empresa o negocio para el que trabaja?******************************************************************************				
			
			if (GM117(i)) IN 3:5,8 THEN
			  if (GM119(i)) IN notappl THEN
				  errmsg("EMP-ERR17,  Si GM117 = 3:5,8 -> GM119 ¿A qué  se dedica o produce la empresa o negocio para el que trabaja? <> Blanco");
				  errmsg("Módulo Empleo");
				  errmsg("PERSONA: %02d, EDAD: %3d, GM117: %d, GM118: %d",
						  PERSONA,       (LP103(i)),  (GM117(i)), (GM119(i)) );
				  errmsg("GM117: %v", (GM117(i)) ); 			  
				  errmsg("GM119: %v", (GM119(i)) ); 	 		  
				  errmsg("  ");
			  endif;
			ENDIF;   //fin

					

{
			  if (GM117(i)) IN 5 THEN
				  if (GM119(i)) IN 1:8 THEN
					if NOT (GM121(i)) IN notappl AND NOT (GM122(i)) IN notappl AND
					NOT (GM123(i)) IN notappl THEN 
					  errmsg("EMP-ERR16.1,  Si GM117 = 5 y GM119=1:8 -> GM121 a GM123 = Blanco");
					  errmsg("Módulo Empleo");
					  errmsg("PERSONA: %02d, EDAD: %3d, GM117: %d, GM119: %d, GM123: %d",
							  PERSONA,   (LP103(i)), (GM117(i)),, (GM119(i)), (GM121(i)),(GM122(i)));
					  errmsg("GM116: %v", (GM116(i)) ); 			  
					  errmsg("GM116E. Especifique: %v", strip(GM116E(i)) ); 	 		  
					  errmsg("  ");
				  endif;
}

//*******************************************¿Cuál es el tamaño de la propiedad?*****************************************************************************				
			
			if (GM119(i)) IN 1 and (GM117(i)) IN 3,4,8 THEN

			  if (GM121(i)) IN notappl THEN
				  errmsg("EMP-ERR16,  Si GM119 = 1 y GM117 = 3,4,8 -> GM121 ¿Cuál es el tamaño de la propiedad? <> BLANCO");
				  errmsg("Módulo Empleo");
				  errmsg("PERSONA: %02d, EDAD: %3d, GM119: %d, GM117: %d, GM121: %d",
						  PERSONA,  (LP103(i)), (GM119(i)),(GM117(i)) ,(GM121(i)) );
				  errmsg("GM119: %d", (GM119(i)) ); 			  
				  errmsg("GM121: %d", (GM117(i)) ); 
				  errmsg("GM122: %d", (GM121(i)) ); 			  					  
				  errmsg("  ");
			  endif;

			endif; //fin A309 in 1:7,77 


//*******************************************¿La situación de su ingreso laboral es*****************************************************************************				
			
			if (GM119(i)) IN 1 and not (GM117(i)) IN 3,4,8 THEN

			  if (GM122(i)) IN notappl THEN
				  errmsg("EMP-ERR16,  Si GM119 = 1 y GM117 <> 3,4,8 -> GM122 ¿La situación de su ingreso laboral es <> BLANCO");
				  errmsg("Módulo Empleo");
				  errmsg("PERSONA: %02d, EDAD: %3d, GM119: %d, GM117: %d, GM122: %d",
						  PERSONA,  (LP103(i)), (GM119(i)),(GM117(i)) ,(GM122(i)) );
				  errmsg("GM119: %d", (GM119(i)) ); 			  
				  errmsg("GM121: %d", (GM117(i)) ); 
				  errmsg("GM122: %d", (GM122(i)) ); 			  					  
				  errmsg("  ");
			  endif;

			endif; //fin A309 in 1:7,77
				

//*******************************************Ingreso laboral*****************************************************************************							

			IF (GM115(i)) in 6 and (GM116(i))in 7:13 THEN

				IF not (GM123(i)) in notappl and not (GM124(i)) in notappl and not (GM125(i)) in notappl  THEN
				   //CONTROLA();
				   errmsg("EMP-ERR118, Si GM115 = 6 y GM116 = 7:13 -> GM123 , GM124 y GM125 = Blanco");
				   errmsg("Módulo Empleo");
				   errmsg("PERSONA: %02d, EDAD: %03d", PERSONA, (LP103(i)));
				   errmsg("GM115: %v", (GM115(i)) ); 	
				   errmsg("GM116: %v", (GM116(i)) ); 
				   errmsg("GM123: %11d", (GM124(i)));				   
				   errmsg("GM124: %11d", (GM124(i)));
				   errmsg("GM125: %11d", (GM125(i)));
				   errmsg("  ");
				ENDIF;

			endif;
			
//**************************************************************************************************************************************					
					
			IF (GM116(i)) = 12 AND (GM124(i)) in notappl THEN
				   errmsg("A-ERR119, Si GM116 = 12 y GM124 = BLANCO");
				   errmsg("Módulo Empleo");
				   errmsg("PERSONA: %02d, EDAD: %03d", PERSONA, (LP103(i)));
				   errmsg("GM116: %v", (GM116(i)) ); 	
				   errmsg("GM125: %11d", (GM124(i)));
				   errmsg("  ");
			ENDIF;
			
//**************************************************************************************************************************************
					 
			IF (GM116(i)) = 9 AND (GM125(i)) in notappl THEN
				   errmsg("A-ERR119, Si GM116 = 9 y GM125 = BLANCO");
				   errmsg("Módulo Empleo");
				   errmsg("PERSONA: %02d, EDAD: %03d", PERSONA, (LP103(i)));
				   errmsg("GM116: %v", (GM116(i)) ); 	
				   errmsg("GM125: %11d", (GM125(i)));
				   errmsg("  ");
			ENDIF;

			 IF (GM116(i)) in 9 then
				if NOT (GM125(i)) IN 0, NotAppl THEN    
					IF (LP103(i)) < 40 THEN  
					   //CONTROLA();
					   errmsg("E-VER120X, Ingreso por Jubilación , GM125 <> 0 y EDAD < 40");
					   errmsg("Módulo Empleo");
					   errmsg("PERSONA: %02d, EDAD: %d, GM116: %11d, GM125: %11d",
										 PERSONA, (LP103(i)), (GM116(i)), (GM125(i)) );
					   errmsg("  ");
					ENDIF;
				endif;
			endif;
//**************************************************************************************************************************************					    
				{						 
					 TOTALL = 0;
				
					 IF NOT (GM123(i)) IN 99999999999, NotAppl THEN TOTALL = TOTALL + (GM123(i)); ENDIF; 
					 IF NOT (GM124(i)) IN 99999999999, NotAppl THEN TOTALL = TOTALL + (GM124(i)); ENDIF; 
					 IF NOT (GM125(i)) IN 99999999999, NotAppl THEN TOTALL = TOTALL + (GM125(i)); ENDIF; 
					 				
					 IF (GM126(i)) = NotAppl THEN
						//CONTROLA();
						errmsg("E-ERR128, Edad 14 y + -> GM126 TOTAL <> BLANCO");
						errmsg("Módulo Empleo");
						errmsg("PERSONA: %02d, Edad: %03d, GM126.TOTAL: %d", PERSONA, (LP103(i)), (GM126(i)));
						errmsg("  ");              
				}
						
		  	 
		  IF (LP103(i)) < 14 OR (GM101(i)) = 6 THEN
				IF (GM115(i)) <> NotAppl OR (GM116(i)) <> NotAppl OR STRIP(GM116E(i)) <> "" or
				(GM117(i)) <> NotAppl OR (GM118(i)) <> NotAppl OR (GM119(i)) <> NotAppl or
				(GM121(i)) <> NotAppl or (GM122(i)) <> NotAppl   THEN
				   //CONTROLA();
				   errmsg("A-ERR130, Edad > 14 años o No es Miembro -> GM115 a GM122 <> BLANCO");
				   errmsg("Módulo Empleo");
				   errmsg("PERSONA: %02d, EDAD: %03d", PERSONA, (LP103(i)));
				   errmsg("Es miembro?: %d", (GM101(i)));
				   errmsg("GM115: %d", (GM115(i)));
				   errmsg("GM116: %d", (GM116(i)));
				   errmsg("GM116. Especifique: %s", strip(GM116E(i)));
				   errmsg("GM117: %d", (GM117(i)));
				   errmsg("GM118: %d", (GM118(i)));
				   errmsg("GM119: %d", (GM119(i)));
				   errmsg("GM121: %d", (GM121(i)));
				   errmsg("GM122: %d", (GM122(i)));
				   errmsg("  ");
				ENDIF;

				IF (GM123(i)) <> NotAppl OR (GM124(i)) <> NotAppl OR (GM125(i)) <> NotAppl or
				   (GM126(i)) <> NotAppl THEN
				   //CONTROLA();
				   errmsg("A-ERR131, Edad > 14 años o No es Miembro -> GM123 a GM126 <> BLANCO");
				   errmsg("Módulo Empleo");
				   errmsg("PERSONA: %02d, EDAD: %03d", PERSONA, (LP103(i)));
				   errmsg("Es miembro?: %d", (GM101(i)));
				   errmsg("GM123: %11d", (GM123(i)));
				   errmsg("GM124: %11d", (GM124(i)));
				   errmsg("GM125: %11d", (GM125(i)));
				   errmsg("GM126: %11d", (GM126(i)));

				   errmsg("  ");
				ENDIF;
		  ENDIF;
		  
	  ENDIF; //fin es miembro = 1 
	  
	  IF (GM101(i)) IN 6 THEN	
 		  errmsg("Es un No Miembro -> GM115 a GM126 <> BLANCO");
	  endif;
	  
	ENDDO;   
	  //fin edad 15:150	
ENDIF;		 
		  
	 
PROC XVAL05

	IF (SITU) IN 1,2 THEN
 //---------------------------------------------
 // VALIDACION DE VIVIENDA
 //---------------------------------------------
	  
      IF NOT (V201) IN 1:7, 99 THEN
         //CONTROLA();
         errmsg("VIV-ERR201, V201 ¿Cual es la situación de la propiedad/vivienda <> 1:7,NR[%02d]", (V201)); 
         errmsg("  ");
      ENDIF;

	  IF  (V201) = 7 AND strip(V201E) = "" THEN
		//CONTROLA();
		  errmsg("VIV-ERR201.1, V201 = %d -> Especifique = BLANCO", (V201));
		  errmsg("   Especifique = %s", V201E);
		  errmsg("  ");
	  ENDIF;	  

	  IF  (V201) in 1:6 AND not strip(V201E) = "" THEN
		//CONTROLA();
		  errmsg("VIV-ERR201.2, V201 = %d -> Especifique <> BLANCO", (V201));
		  errmsg("   Especifique = %s", V201E);
		  errmsg("  ");
	  ENDIF;
	  
//***********************************************************************************************************************************************	  
	  IF (V202A) in notappl then 
			//CONTROLA();
			errmsg("VIV-ERR202, Fuera de rango: (V202) Cantidad de piezas no debe ser BLANCO"); 
			errmsg("------------------");
			errmsg(" ");
		ENDIF;

		IF NOT (V202A) IN 0:20, 99 THEN
			//CONTROLA();
			errmsg("VIV-ERR202.1, (V202A) Cantidad de piezas <> 0:20 ,NR [%02d]", (V202A)); 
			errmsg("------------------");
			errmsg(" ");
		ENDIF;
		
		IF (V202B) in notappl then 
			//CONTROLA();
			errmsg("VIV-ERR202.2, Fuera de rango: (V202B) Cantidad de dormitorios no debe ser BLANCO"); 
			errmsg("------------------");
			errmsg(" ");
		ENDIF;
	  
		IF NOT (V202B) IN 0:20, 99 THEN
			//CONTROLA();
			errmsg("VIV-ERR202.3, (V202B) Cantidad de dormitorios <> 0:20 , NR [%02d]", (V202B)); 
			errmsg("------------------");
			errmsg(" ");
		ENDIF;
	  
	  
		IF  (V202B) >  (V202A) THEN
			errmsg("VIV-ERR202.4, Número de dormitorios [V202B: %02d] > Piezas [V202A:%02d]",  (V202B),  (V202A)); 
			errmsg("------------------");
			errmsg(" ");
		ENDIF;
	  
	  
//***********************************************************************************************************************************************
	  IF NOT (V203) IN 1:9, 99 THEN
         //CONTROLA();
         errmsg("VIV-ERR203, V203 ¿De qué material es la mayor parte de las paredes de esta vivienda? <> 1:9, NR [%02d]", (V203)); 
         errmsg("------------------");
		 errmsg(" ");
      ENDIF;	
	  
		IF (V203) IN 1:8 AND V203E <> " " THEN   // 200727                                   // R200429
		//CONTROLA();
			errmsg("VIV-ERR203.1, V203 ¿De qué material es la mayor parte de las paredes de esta vivienda?  = 1:8 -> Especifique = BLANCO)");   // 200727  // R200429
			errmsg("Material de las paredes: %02d, Especifique: %s", (V203), V203E);
			errmsg("------------------");
			errmsg(" ");
		ENDIF;

	   IF (V203) = 9 AND V203E = " " THEN
		  //CONTROLA();
		  errmsg("VIV-ERR203.2, (V203) ¿De qué material es la mayor parte de las paredes de esta vivienda? = 9 -> Especifique <> BLANCO)");
		  errmsg("Material de las paredes: %02d, Especifique: %s", (V203), V203E);
		  errmsg("------------------");
		  errmsg(" ");
	   ENDIF;

//***********************************************************************************************************************************************	  
	  IF NOT (V204) IN 1:9, 99 THEN
         //CONTROLA();
         errmsg("VIV-ERR204, V204 Material del piso <> 1:9, NR [%02d]", (V204)); 
         errmsg("------------------");
		 errmsg(" ");
      ENDIF;	
	  
		IF (V204) IN 1:8 AND V204E <> " " THEN   // 200727                                   // R200429
		//CONTROLA();
			errmsg("VIV-ERR204.1, V204 Material del piso  = 1:8 -> Especifique = BLANCO)");   // 200727  // R200429
			errmsg("Material del piso: %02d, Especifique: %s", (V204), V204E);
			errmsg("------------------");
			errmsg(" ");
		ENDIF;

	   IF (V204) = 9 AND V204E = " " THEN
		  //CONTROLA();
		  errmsg("VIV-ERR204.2, (V204) Material del piso  = 9 -> Especifique <> BLANCO)");
		  errmsg("Material del piso: %02d, Especifique: %s", (V204), V204E);
		  errmsg("------------------");
		  errmsg(" ");
	   ENDIF;

//***********************************************************************************************************************************************
      IF NOT (V205) IN 1:9, 99 THEN
         //CONTROLA();
         errmsg("VIV-ERR205, V205 ¿De qué material es la mayor parte del techo de esta vivienda? <> 1:9, NR [%02d]", (V205)); 
         errmsg("------------------");
		 errmsg(" ");
      ENDIF;	
	  
		IF (V205) IN 1:8 AND V205E <> " " THEN   // 200727                                   // R200429
		//CONTROLA();
			errmsg("VIV-ERR205.1, V205 ¿De qué material es la mayor parte del techo de esta vivienda? = 1:8 -> Especifique = BLANCO)");   // 200727  // R200429
			errmsg("Material del techo: %02d, Especifique: %s", (V205), V205E);
			errmsg("------------------");
			errmsg(" ");
		ENDIF;

	   IF (V205) = 9 AND V205E = " " THEN
		  //CONTROLA();
		  errmsg("VIV-ERR205.2, (V205) ¿De qué material es la mayor parte del techo de esta vivienda? = 9 -> Especifique <> BLANCO)");
		  errmsg("Material del techo: %02d, Especifique: %s", (V205), V205E);
		  errmsg("------------------");
		  errmsg(" ");
	   ENDIF;

//***********************************************************************************************************************************************
     
	    IF NOT (V206) IN 1:14, 99 THEN
			//CONTROLA();
			errmsg("VIV-ERR206, (V206) ¿El agua que más beben en el hogar proviene de... <> 1:14, NR [%02d]", (V206)); 
			errmsg("------------------");
			errmsg(" ");
		ENDIF;
		

		IF (V206) IN 1:13, 99 AND V206E <> " " THEN   // 200727                                   // R200429
			//CONTROLA();
			errmsg("VIV-ERR206.1, (V206) ¿El agua que más beben en el hogar proviene de  = 1:13, NR -> Especifique = BLANCO)");   // 200727  // R200429
			errmsg("Vivienda , Agua que beben: %02d, Especifique: %s", (V206), V206E);
			errmsg("------------------");
			errmsg(" ");
		ENDIF;
	   
	   
	   IF (V206) = 14 AND V206E = " " THEN
			//CONTROLA();
			errmsg("VIV-ERR206.2, (V206) ¿El agua que más beben en el hogar proviene de = 14 -> Especifique <> BLANCO)");
			errmsg("Vivienda, Agua que beben: %02d, Especifique: %s", (V206), V206E);
			errmsg("------------------");
			errmsg(" ");
		ENDIF;
		
//***********************************************************************************************************************************************
		IF NOT (V207) IN 1:4, 99 THEN
			//CONTROLA();
			errmsg("VIV-ERR207, (V207) Para cocinar usa <> 1:7, NR [%02d]", (V207)); 
			errmsg("------------------");
			errmsg(" ");
		ENDIF;
	  
		IF (V207) IN 1:3, 99 AND V207E <> " " THEN   // 200727                                   // R200429
			//CONTROLA();
			errmsg("VIV-ERR207.1, (V207) Para cocinar usa  = 1:3, NR -> Especifique = BLANCO)");   // 200727  // R200429
			errmsg("Para cocinar usa: %02d, Especifique: %s", (V207), V207E);
			errmsg("------------------");
			errmsg(" ");
		ENDIF;

		IF (V207) = 4 AND V207E = " " THEN
			//CONTROLA();
			errmsg("VIV-ERR207.2, (V207) Para cocinar usa  = 4 -> Especifique <> BLANCO)");
			errmsg("Vivienda, Para cocinar usa: %02d, Especifique: %s", (V207), V207E);
			errmsg("------------------");
			errmsg(" ");
		ENDIF;
	   
//***********************************************************************************************************************************************
		IF NOT (V208) IN 1:4,99 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR208, V208 ¿Tiene acceso a electricidad? <> 1:4, NR [%02d]", (V208)); 
			 errmsg("  ");
		ENDIF;
		
		IF (V208) IN 2:4,99 and (V209) <> notappl THEN
			 //CONTROLA();
			 errmsg("VIV-ERR208.1, V208 ¿Tiene acceso a electricidad? = 2:4, NR  -> V209 ¿El hogar cuenta con tarifa social? <> a blanco "); 
			 errmsg("  VIVienda, V208 : %d, V209: %d ", (V208),(V209) );
			 errmsg("  ");
		ENDIF;
	  
		IF  (V208) = 4 AND strip(V204E) = "" THEN
			//CONTROLA();
			  errmsg("VIV-ERR208.2, V208 = %d -> Especifique <> BLANCO",(V208));
			  errmsg("   Especifique = %s", V204E);
			  errmsg("  ");
		ENDIF;	
		
		IF  (V208) in 1:3,99 AND not strip(V208E) = "" THEN
			//CONTROLA();
			  errmsg("VIV-ERR208.3, V208 = %d -> Especifique = BLANCO",(V208));
			  errmsg("   Especifique = %s", V208E);
			  errmsg("  ");
		ENDIF;	

//***********************************************************************************************************************************************	  
	  
	  IF not (V208) IN 2:4,99 THEN
		  IF NOT (V209) IN 1, 6, 99 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR209, V209 ¿El hogar cuenta con tarifa social? <> 1, 6, NR [%02d]", (V209)); 
			 errmsg("  ");
		  ENDIF;
	  ENDIF;	
	  
//***********************************************************************************************************************************************
		IF NOT (V210) IN 1:9, 99 THEN
			//CONTROLA();
			errmsg("VIV-ERR210, (V210) ¿El baño se desagua en <> 1:9, NR [%02d]", (V210)); 
			errmsg("------------------");
		ENDIF;
		

		IF (V210) IN 1:7,9, 99 AND V210E <> " " THEN   // 200727                                   // R200429
			//CONTROLA();
			errmsg("VIV-ERR210.1, (V210) ¿El baño se desagua en = 1:7,9 NR -> Especifique = BLANCO)");   // 200727  // R200429
			errmsg("Vivienda , Tipo de desague: %02d, Especifique: %s", (V210), V210E);
			errmsg("------------------");
			errmsg(" ");
		ENDIF;
	   
	   
	   IF (V210) = 8 AND V210E = " " THEN
			//CONTROLA();
			errmsg("VIV-ERR210.2, (V210) ¿El baño se desagua en  = 8 -> Especifique <> BLANCO)");
			errmsg("Vivienda , Tipo de desague: %02d, Especifique: %s", (V210), V210E);
			errmsg("------------------");
			errmsg(" ");
		ENDIF;

//***********************************************************************************************************************************************
		IF NOT (V211_1) IN 1, 6, 99 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR211, V211_1 ¿El hogar cuenta con computador/notebook? <> 1, 6, NR [%02d]", (V211_1)); 
			 errmsg("  ");
		ENDIF;
		
		IF NOT (V211_2) IN 1, 6, 99 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR211.1, V211_2 ¿El hogar cuenta con tableta o dispositivo similar?? <> 1, 6, NR [%02d]", (V211_2)); 
			 errmsg("  ");
		ENDIF;

//***********************************************************************************************************************************************
		IF NOT (V212) IN 1, 6, 99 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR212, V212 Acceso a internet <> 1, 6, NR [%02d]", (V212));
			 errmsg("------------------");
		ENDIF;

//***********************************************************************************************************************************************
		  IF NOT (V213_1) IN 1,6, 99 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR213, V213_1 radio? <> 1, 6, NR [%02d]", (V213_1)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;

		  IF NOT (V213_2) IN 1,6, 99 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR213.1, V213_2 televisor? <> 1, 6, NR [%02d]", (V213_2)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;	
	  
	  
		   IF NOT (V213_3) IN 1,6, 99 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR213.2, V213_3 heladera? <> 1, 6, NR [%02d]", (V213_3)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;

		  IF NOT (V213_4) IN 1,6, 99 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR213.3, V213_4 cocina a gas? <> 1, 6, NR [%02d]", (V213_4)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;	
		  

		  IF NOT (V213_4A) IN 1,6, 99 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR213.4, V213_4A cocina eléctrica? <> 1, 6, NR [%02d]", (V213_4A)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;

		  IF NOT (V213_5) IN 1,6, 99 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR213.5, V213_5 máquina lavarropa? <> 1, 6, NR [%02d]", (V213_5)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;	
		  
		  
		   IF NOT (V213_6) IN 1,6, 99 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR213.6, V213_6 video/DVD? <> 1, 6, NR [%02d]", (V213_6)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;

		  IF NOT (V213_7) IN 1,6, 99 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR213.7, V213_7 termocalefón? <> 1, 6, NR [%02d]", (V213_7)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;	

		  IF NOT (V213_8) IN 1,6, 99 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR213.8, V213_8 acondicionador de aire? <> 1, 6, NR [%02d]", (V213_8)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;	
		  

		  IF NOT (V213_9) IN 1,6, 99 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR213.9, V213_9 antena parabólica? <> 1, 6, NR [%02d]", (V213_9)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;

		  IF NOT (V213_10) IN 1,6, 99 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR213.10, V213_10 TV cable? <> 1, 6, NR [%02d]", (V213_10)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;	
		  
		  
		   IF NOT (V213_11) IN 1,6, 99 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR213.11, V213_11 horno microondas? <> 1, 6, NR [%02d]", (V213_11)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;

		  IF NOT (V213_12) IN 1,6, 99 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR213.12, V213_12 horno eléctrico? <> 1, 6, NR [%02d]", (V213_12)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;	  
		  

		  IF NOT (V213_13) IN 1,6, 99 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR213.13, V213_13 automóvil, camión o camioneta? <> 1, 6, NR [%02d]", (V213_13)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;	
		  
		  IF NOT (V213_14) IN 1,6, 99 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR213.14, V213_14 motocicleta? <> 1, 6, NR [%02d]", (V213_14)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;
//****************************************************************************************************************************************

		  IF (V213_1) = NotAppl AND (V213_2) = NotAppl AND 
			 (V213_3) = NotAppl AND (V213_4) = NotAppl AND
			 (V213_4A) = NotAppl AND (V213_5) = NotAppl AND 
			 (V213_6) = NotAppl AND (V213_7) = NotAppl AND
			 (V213_8) = NotAppl AND (V213_9) = NotAppl AND 
			 (V213_10) = NotAppl AND (V213_11) = NotAppl AND 
			 (V213_12) = NotAppl AND (V213_13) = NotAppl AND 
			 (V213_14) = NotAppl THEN
			 //CONTROLA();
			 errmsg("VIV-VER213, VER, NO se registra la tenencia de algún bien en V213");
			 errmsg("Radio	 					 : %02d", (V213_1));   
			 errmsg("Televidor     				 : %02d", (V213_2));
			 errmsg("Heladera 					 : %02d", (V213_3));
			 errmsg("Cocina a gas  	    		 : %02d", (V213_4));
			 errmsg("Cocina eléctrica    		     : %02d", (V213_4A));
			 errmsg("Máquina lavarropa	 		 : %02d", (V213_5));   
			 errmsg("Video/DVD      				 : %02d", (V213_6));
			 errmsg("Termocalefón 		 		 : %02d", (V213_7));
			 errmsg("Acondicionador de aire		 : %02d", (V213_8));
			 errmsg("Antena parabólica     		 : %02d", (V213_9));
			 errmsg("TV cable		 		 		 : %02d", (V213_10));   
			 errmsg("Horno microondas      		 : %02d", (V213_11));
			 errmsg("Horno eléctrico 				 : %02d", (V213_12));
			 errmsg("Automóvil, camión o camioneta : %02d", (V213_13));
			 errmsg("Motocicleta    			     : %02d", (V213_14));
			errmsg("  ");
		  ENDIF;
	  		  
		    
	//****************************************************************************************************************************************

		  IF NOT (V214) IN 1:6, 99 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR214, V214 ¿Hay personas que necesitan independizarse en la vivienda y no lo han hecho por falta de recursos? <> 1:6, NR [%02d]", (V214)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;	
		
		  
			IF (V214) IN 1:4,6 AND V214E <> "" THEN   // 200727                                   // R200429
			//CONTROLA();
				errmsg("VIV-ERR214.1, V214 ¿Hay personas que necesitan independizarse en la vivienda y no lo han hecho por falta de recursos?  = 1:4,6 -> Especifique = BLANCO)");   // 200727  // R200429
				errmsg("Vivienda: %02d, Especifique: %s", (V214), V214E);
				errmsg("------------------");
				errmsg(" ");
			ENDIF;

		   IF (V214) = 5 AND V214E = "" THEN
			  //CONTROLA();
			  errmsg("VIV-ERR214.2, (V214) ¿Hay personas que necesitan independizarse en la vivienda y no lo han hecho por falta de recursos? = 5 -> Especifique <> BLANCO)");
			  errmsg("Vivienda: %02d, Especifique: %s", (V214), V214E);
			  errmsg("------------------");
			  errmsg(" ");
		   ENDIF;

	//****************************************************************************************************************************************

		  IF NOT (V215) IN 1:3 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR215, V215 Caminos y medio de transporte para acceder a la vivienda <> 1:3 [%d]", (V215)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;	  
		  

		  IF NOT (V216) IN 1:5 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR216, V216 Tipo de vivienda <> 1:5 [%d]", (V216)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;	
		  
		  IF NOT (V217) IN 1:4 THEN
			 //CONTROLA();
			 errmsg("VIV-ERR217, V217 Situación de la vivienda. ¿Cual es la necesidad de mejora según la observación? <> 1:4 [%d]", (V217)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;	
		  
//****************************************************************************************************************************************
		 
		  IF  strip(V218O) IN "" THEN
			 //CONTROLA();
			 errmsg("VIV-ERR218, V218O Comentarios del Censista = BLANCO [%s] -> Comentarios <> BLANCO", strip(V218O)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;	
		
//***********************************************************************************************************************************************
			IF NOT (V219) IN 1,6 THEN
				 //CONTROLA();
				 errmsg("VIV-ERR219, V219 ¿Considera que los datos provehidos por la familia son dudosos? <> 1:6 [%d]", (V219)); 
				 errmsg("------------------");
				 errmsg(" ");
			ENDIF;

//------------------------------------------------------------------------------------------------------------

	endif;
//----------------------------------------------------------------------------------------------------------------
PROC XVAL06

	IF (SITU) IN 1,2 THEN
	 
		//Persona = (L02(i));

		string nomeArch="";
		
		string notasName;
		
		if getos() in 20:29 then
			notasName = maketext("%s\",pathname(Application) );//[1:(xlargo_ruta1-4)]
		else
			notasName = maketext("%s\",pathname(Application) );//[1:(xlargo_ruta1-4)]
			
		endif;
//*************************************¿Presentó certificado de no contribuyente?***************************************************************************************************
 
	IF NOT (D101) IN 1,6 THEN
		 //CONTROLA();
		 errmsg("DOC-ERR001, D101 ¿Presentó certificado de no contribuyente? <> 1,6 [%d]", (D101)); 
		 errmsg("------------------");
		 errmsg(" ");
	ENDIF;	

 	//IF (D101) IN 6 AND not (D01_1(i)) in notappl THEN
	IF D101 IN 6 AND TOTOCC(REG_D01_EDT) > 0 THEN
		errmsg("DOC-ERR001.1, D101 ¿Presentó certificado de no contribuyente? = 6 -> Registro de certificado de No contribuyente  = BLANCO,0)");   // 200727  // R200429
		errmsg("Filtro de D101: %d, Registro de Documentos: %d, ",D101, TOTOCC(REG_D01_EDT));
		errmsg("------------------");
		errmsg(" ");
	ENDIF;

	IF D101 IN 1 AND TOTOCC(REG_D01_EDT) = 0 THEN
		errmsg("DOC-ERR001.2, D101 ¿Presentó certificado de no contribuyente? = 1 y Registro de certificado de No contribuyente  = 0)");
		errmsg("Filtro de D101: %d, Registro de Documentos: %d, ",D101, TOTOCC(REG_D01_EDT));
		errmsg("------------------");
		errmsg(" ");
	ENDIF;

	IF D101 IN 1 THEN

		if TOTOCC(REG_D01_EDT) > 0 then
		
			do i=1 while i <= TOTOCC(REG_D01_EDT);
			
				do j=1 while j <= (TOTALPERSONAS);
			
					IF visualvalue(LP103(j)) < 18  and  (L02(j)) =  (ld01(i)) THEN 
					
					  errmsg("DOC-ERR001.3-EDAD, EDAD no corresponde >18)");
					  errmsg("Persona: %d, Documento: %d, D01_1: %d",(LD01(i)), (D101), (D01_1(i)));
					  errmsg("------------------");
					  errmsg(" ");

					endif;
				enddo;	
			
			    nomeArch= strip(notasName)+"base_fotos\"+strip(ci_clave)+"_"+maketext ("%d",(LD01(i)))+"_EST_FOTO_D01.jpg";
			   
			   IF D01_1(i)  in 1 THEN
				  IF !fileexist(nomeArch) THEN
				  //CONTROLA();
				  errmsg("DOC-ERR001.4, D101 ¿Presentó certificado de no contribuyente? = 1 y D01_1 = 1-> IMAGEN <> BLANCO)");
				  errmsg("Persona: %d, Filtro de Documento: %d, D01_1: %d",(LD01(i)), (D101), (D01_1(i)));
				  errmsg("------------------");
				  errmsg(" ");
				  ENDIF;
			   ENDIF;  

			   IF D01_1(i)  in 6 THEN
				  IF fileexist(nomeArch) THEN
				  //CONTROLA();
				  errmsg("DOC-ERR001.5, D101 ¿Presentó certificado de no contribuyente? = 1 y D01_1 = 6 y IMAGEN <> BLANCO)");
				  errmsg("Persona: %d, Filtro de Documento: %d, D01_1: %d",(LD01(i)), (D101), (D01_1(i)));
				  errmsg("------------------");
				  errmsg(" ");
				  ENDIF;
			   ENDIF;  
			   
		   enddo;	
		ENDIF; 

	Endif;
			
	   
//*****************************************¿Presentó certificado de trabajo o boleta de IPS de todos los que corresponde?***********************************************************************************************

	IF NOT (D102) IN 1,6 THEN
		 //CONTROLA();
		 errmsg("DOC-ERR002, D102 ¿Presentó certificado de trabajo o boleta de IPS de todos los que corresponde? <> 1,6 [%d]", D102); 
		 errmsg("------------------");
		 errmsg(" ");
	ENDIF;	

 
	IF (D102) IN 6 AND TOTOCC(REG_D02_EDT) > 0 THEN
	//CONTROLA();
		errmsg("DOC-ERR002.1, D102 ¿Presentó certificado de trabajo o boleta de IPS de todos los que corresponde? = 6 -> Registro de certificado de trabajo o boleta de IPS = BLANCO,0)");
		errmsg("Filtro de D102: %d, Registro de Documentos: %d, ",D102, TOTOCC(REG_D02_EDT));
		errmsg("------------------");
		errmsg(" ");
	ENDIF;

	IF (D102) IN 1 AND TOTOCC(REG_D02_EDT) = 0 THEN
	//CONTROLA();
		errmsg("DOC-ERR002.2, D102 ¿Presentó certificado de trabajo o boleta de IPS de todos los que corresponde? = 1 y Registro de certificado de trabajo o boleta de IPS = 0)");
		errmsg("Filtro de D102: %d, Registro de Documentos: %d, ",D102, TOTOCC(REG_D02_EDT));
		errmsg("------------------");
		errmsg(" ");
	ENDIF;

	IF D102 IN 1 THEN
	
		if TOTOCC(REG_D02_EDT) > 0 then
		   do i=1 while i <= TOTOCC(REG_D02_EDT);
			
				do j=1 while j <= (TOTALPERSONAS);
			
					IF (LP103(j)) < 18  and  (L02(j)) =  (ld02(i)) THEN 
					
					  errmsg("DOC-ERR002.3-EDAD, EDAD no corresponde >18)");
					  errmsg("Persona: %d, Documento: %d, D01_1: %d",(ld02(i)), D102, (D02_1(i)));
					  errmsg("------------------");
					  errmsg(" ");

					endif;
				enddo;	

			  nomeArch= strip(notasName)+"base_fotos\"+strip(ci_clave)+"_"+maketext ("%d",(LD02(i)))+"_EST_FOTO_D02_1.jpg";

			  IF D02_1(i)  in 1 THEN
				  IF !fileexist(nomeArch) THEN
					  //CONTROLA();
					  errmsg("DOC-ERR002.4, D102 ¿Presentó certificado de trabajo o boleta de IPS de todos los que corresponde? = 1 y D02_1 = 1-> IMAGEN <> BLANCO)");
					  errmsg("Persona: %d, Documentos: %d, D01_1: %d", LD02(i), D102, D02_1(i) );
					  errmsg("------------------");
					  errmsg(" ");
				  ENDIF;
			  ENDIF;  
			  IF D02_1(i)  in 6 THEN
				  IF fileexist(nomeArch) THEN
					  //CONTROLA();
					  errmsg("DOC-ERR002.5, D102 ¿Presentó certificado de trabajo o boleta de IPS de todos los que corresponde? = 1 y D02_1 = 6 y IMAGEN <> BLANCO)");
					  errmsg("Persona: %d, Documentos: %d, D01_1: %d", LD02(i), D102, D02_1(i) );
					  errmsg("------------------");
					  errmsg(" ");
				  ENDIF;
			  ENDIF;  
		  
		   enddo;	
		endif;
	ENDIF;

	
//*****************************************¿Presentó 3 últimos comprobantes de IVA?***********************************************************************************************

	IF NOT (D103) IN 1,6 THEN
		 errmsg("DOC-ERR003,  D103 ¿Presentó 3 últimos comprobantes de IVA? <> 1,6 [%d]", D103); 
		 errmsg("------------------");
		 errmsg(" ");
	ENDIF;	

	IF (D103) IN 6 AND TOTOCC(REG_D03_EDT) > 0 THEN
	//CONTROLA();
		errmsg("DOC-ERR003.1, D103 ¿Presentó 3 últimos comprobantes de IVA? = 6 -> Registro de comprobante de IVA = BLANCO,0)");
		errmsg("Filtro de D103: %d, Registro de Documentos: %d, ",D103, TOTOCC(REG_D03_EDT));
		errmsg("------------------");
		errmsg(" ");
	ENDIF;

	IF (D103) IN 1 AND TOTOCC(REG_D03_EDT) = 0 THEN
	//CONTROLA();
		errmsg("DOC-ERR003.2, D103 ¿Presentó 3 últimos comprobantes de IVA? = 1 y Registro de comprobante de IVA = 0)");
		errmsg("Filtro de D103: %d, Registro de Documentos: %d, ",D103, TOTOCC(REG_D03_EDT));
		errmsg("------------------");
		errmsg(" ");
	ENDIF;

	IF D103 IN 1 THEN
		if TOTOCC(REG_D03_EDT) > 0 then
		
			do i=1 while i <= TOTOCC(REG_D01_EDT);

				  do J=1 while J <= TOTOCC(REG_D03_EDT);	
					
						IF (LD01(i)) = (LD03(J)) THEN
						
							 IF (D01_1(i)) in 6 THEN
								  IF (D03_A1_C1(J)) in 6 THEN
									  errmsg("DOC-VER_100, La persona no es contribuyente -> no tiene documento en iva )");
									  errmsg("Persona: %d , D01_1: %d, D03_A1_C1: %d", (LD03(i)), (D01_1(i)), (D03_A1_C1(J)));
									  errmsg("------------------");
									  errmsg(" ");
								  ENDIF;
							 ENDIF;
							 
							 IF (D01_1(i)) in 1 THEN
								  IF (D03_A1_C1(J)) in 1 THEN
									  errmsg("DOC-VER_101, La persona es contribuyente -> tiene documento en iva )");
									  errmsg("Persona: %d , D01_1: %d, D03_A1_C1: %d", (LD03(i)), (D01_1(i)), (D03_A1_C1(J)));
									  errmsg("------------------");
									  errmsg(" ");
								  ENDIF;
							 ENDIF;
						 
						ENDIF;			 
				  enddo;	   
			enddo;	   

			do i=1 while i <= TOTOCC(REG_D03_EDT);
			
				do j=1 while j <= (TOTALPERSONAS);
			
					IF (LP103(j)) < 18  and  (L02(j)) =  (ld03(i)) THEN 
					
					  errmsg("DOC-ERR003.3-EDAD, EDAD no corresponde >18)");
					  errmsg("Persona: %d, Documento: %d, D01_1: %d",(ld03(i)), (D103), (D03_A1_C1(i)));
					  errmsg("------------------");
					  errmsg(" ");

					endif;
				enddo;	

				IF (D03_A1_C1(i)) in notappl THEN
					errmsg("DOC-ERR003.4, D103 ¿Presentó 3 últimos comprobantes de IVA? = 1 y D03_A1_C1 = BLANCO)");
					errmsg("Persona: %d ,Documentos: %d, D01_1: %d", (LD03(i)), (D103), (D03_A1_C1(i)));
					errmsg("------------------");
					errmsg(" ");
				ENDIF;
				
			   nomeArch= strip(notasName)+"base_fotos\"+strip(ci_clave)+"_"+maketext ("%d",(LD03(i)))+"_ESF_PC_H1.jpg";
			   IF D03_A1_C1(i)  in 1 THEN
				   IF !fileexist(nomeArch) THEN
					  errmsg("DOC-ERR003.5, D103 ¿Presentó 3 últimos comprobantes de IVA? = 1 y D03_A1_C1 = 1-> IMAGEN 1 <> BLANCO)");
					  errmsg("Persona: %d ,Documentos: %d, D03_A1_C1: %d", (LD03(i)), (D103), (D03_A1_C1(i)));
					  errmsg("------------------");
					  errmsg(" ");
				  ENDIF;
			   ENDIF;  
			   IF D03_A1_C1(i)  in 6 THEN
				   IF fileexist(nomeArch) THEN
					  errmsg("DOC-ERR003.5B, D103 ¿Presentó 3 últimos comprobantes de IVA? = 1 y D03_A1_C1 = 6 y IMAGEN 1 <> BLANCO)");
					  errmsg("Persona: %d ,Documentos: %d, D03_A1_C1: %d", (LD03(i)), (D103), (D03_A1_C1(i)));
					  errmsg("------------------");
					  errmsg(" ");
				  ENDIF;
			   ENDIF;  
			   
			   nomeArch= strip(notasName)+"base_fotos\"+strip(ci_clave)+"_"+maketext ("%d",(LD03(i)))+"_ESF_PC_H1.jpg";
			   IF D03_A1_C2(i)  in 1 THEN
				  IF !fileexist(nomeArch) THEN
					  errmsg("DOC-ERR003.6, D103 ¿Presentó 3 últimos comprobantes de IVA? = 1 y D03_A1_C2 = 1-> IMAGEN 2 <> BLANCO)");
					  errmsg("Persona: %d ,Documentos: %d, D03_A1_C2: %d", (LD03(i)), (D103), (D03_A1_C2(i)));
					  errmsg("------------------");
					  errmsg(" ");
				  ENDIF;
			   ENDIF;
			   IF D03_A1_C2(i)  in 6 THEN
				  IF fileexist(nomeArch) THEN
					  errmsg("DOC-ERR003.6B, D103 ¿Presentó 3 últimos comprobantes de IVA? = 1 y D03_A1_C2 = 6 y IMAGEN 2 <> BLANCO)");
					  errmsg("Persona: %d ,Documentos: %d, D03_A1_C2: %d", (LD03(i)), (D103), (D03_A1_C2(i)));
					  errmsg("------------------");
					  errmsg(" ");
				  ENDIF;
			   ENDIF;
			   
			   nomeArch= strip(notasName)+"base_fotos\"+strip(ci_clave)+"_"+maketext ("%d",(LD03(i)))+"_ESF_PC_H1.jpg";
			   IF D03_A1_C3(i)  in 1 THEN
				  IF !fileexist(nomeArch) THEN
					  errmsg("DOC-ERR003.7, D103 ¿Presentó 3 últimos comprobantes de IVA? = 1 y D03_A1_C3 = 1-> IMAGEN 3 <> BLANCO)");
					  errmsg("Persona: %d ,Documentos: %d, D03_A1_C3: %d", (LD03(i)), (D103), (D03_A1_C3(i)));
					  errmsg("------------------");
					  errmsg(" ");
				  ENDIF;
			   ENDIF;
			   IF D03_A1_C3(i)  in 6 THEN
				  IF fileexist(nomeArch) THEN
					  errmsg("DOC-ERR003.7B, D103 ¿Presentó 3 últimos comprobantes de IVA? = 1 y D03_A1_C3 = 6 y IMAGEN 3 <> BLANCO)");
					  errmsg("Persona: %d ,Documentos: %d, D03_A1_C3: %d", (LD03(i)), (D103), (D03_A1_C3(i)));
					  errmsg("------------------");
					  errmsg(" ");
				  ENDIF;
			   ENDIF;
			   
			   IF (OTRA_ACTI2(i)) in 6 THEN
				  IF (D03_A2_C1(i)) <> notappl and (D03_A2_C2(i)) <> notappl and (D03_A2_C3(i)) <> notappl THEN
					  errmsg("DOC-ERR003.8, OTRA_ACTI2 = 6 -> D03_A2_C1 a D03_A2_C3 = BLANCO)");
					  errmsg("Persona: %d , OTRA_ACTI2: %d, D03_A2_C1: %d, D03_A2_C2: %d, D03_A2_C3: %d", (LD03(i)), (OTRA_ACTI2(i)), (D03_A2_C1(i)), (D03_A2_C2(i)),  (D03_A2_C3(i)));
					  errmsg("------------------");
					  errmsg(" ");
				  ENDIF;
			   ENDIF;
			enddo;	
		ENDIF; 

	ENDIF;	

	
//*******************************************¿Presentó certificado de vida y residencia? *********************************************************************************************

		  IF NOT (D104) IN 1,6 THEN
			 //CONTROLA();
			 errmsg("DOC-ERR004, D104 ¿Presentó certificado de vida y residencia? <> 1,6 [%d]", (D104)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;	
		
		  nomeArch= strip(notasName)+"base_fotos\"+strip(ci_clave)+"_D104_1.jpg";	
		  IF (D104) IN 1 THEN // 200727                                   // R200429
			 IF !fileexist(nomeArch) THEN
				//CONTROLA();
				errmsg("DOC-ERR004.1, D104 ¿Presentó certificado de vida y residencia? = 1 -> D104_1 <> BLANCO)");
				errmsg("Documentos: %d", (D104));
				errmsg("------------------");
				errmsg(" ");
		     endif;
		  ENDIF;

		  IF (D104) IN 6 THEN // 200727                                   // R200429
			 IF fileexist(nomeArch) THEN
				//CONTROLA();
				errmsg("DOC-ERR004.2, D104 ¿Presentó certificado de vida y residencia? = 6 y D104_1 <> BLANCO)");
				errmsg("Documentos: %d", (D104));
				errmsg("------------------");
				errmsg(" ");
		     endif;
		  ENDIF;
		  
//****************************************¿Presentó copia de la boleta del servicio público ANDE?************************************************************************************************
		
		IF NOT (D105) IN 1,6 THEN
			 //CONTROLA();
			 errmsg("DOC-ERR005, D105 ¿Presentó copia de la boleta del servicio público ANDE? <> 1,6 [%d]", (D105)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;	
		
		 nomeArch= strip(notasName)+"base_fotos\"+strip(ci_clave)+"_D05_1.jpg";	

		 IF D105 IN 1 THEN
			 IF !fileexist(nomeArch) THEN
				errmsg("DOC-ERR005.1, D105 ¿Presentó copia de la boleta del servicio público ANDE? = 1 -> D105_1 <> BLANCO)");
				errmsg("Documentos: %d", (D105));
				errmsg("------------------");
				errmsg(" ");
			 ENDIF;
		  ENDIF;
		 IF D105 IN 6 THEN
			 IF fileexist(nomeArch) THEN
				errmsg("DOC-ERR005.2, D105 ¿Presentó copia de la boleta del servicio público ANDE? = 6 y D105_1 <> BLANCO)");
				errmsg("Documentos: %d", (D105));
				errmsg("------------------");
				errmsg(" ");
			 ENDIF;
		  ENDIF;
		  
//***************************************¿Presentó certificado de discapacidad, de todos los miembros del hogar con discapacidad?*************************************************************************************************
        
		IF NOT (D106) IN 1,6 THEN
		   //CONTROLA();
		   errmsg("DOC-ERR006, D106 ¿Presentó certificado de discapacidad, de todos los miembros del hogar con discapacidad? <> 1,6 [%d]", (D106)); 
		   errmsg("------------------");
		   errmsg(" ");
		ENDIF;	

		IF (D106) IN 6 AND TOTOCC(REG_D06_EDT) > 0 THEN
		//CONTROLA();
			errmsg("DOC-ERR006.1, D106 ¿Presentó certificado de discapacidad, de todos los miembros del hogar con discapacidad? = 6 -> Registro de Discapacidad debe estar en BLANCO)");
			errmsg("Filtro discapacidad: %d  Registro de Documentos: %d", D106, TOTOCC(REG_D06_EDT));
			errmsg("------------------");
			errmsg(" ");
		ENDIF;
			 
		IF (D106) IN 1 AND TOTOCC(REG_D06_EDT) = 0 THEN
		//CONTROLA();
			errmsg("DOC-ERR006.2, D106 ¿Presentó certificado de discapacidad, de todos los miembros del hogar con discapacidad? = 1 y Registro de Discapacidad =0)");
			errmsg("Filtro discapacidad: %d  Registro de Documentos: %d", D106, TOTOCC(REG_D06_EDT));
			errmsg("------------------");
			errmsg(" ");
		ENDIF;

	    IF TOTOCC(REG_D06_EDT) > 0 THEN 		
			do i=1 while i <= TOTOCC(REG_D06_EDT);
			

			  nomeArch= strip(notasName)+"base_fotos\"+strip(ci_clave)+"_"+maketext ("%d",(LD06(i)))+"_EST_FOTO_D06_1.jpg";
			   IF D06_1(i)  in 1 THEN
				 IF !fileexist(nomeArch) THEN
					  errmsg("DOC-ERR006.2, D106 ¿Presentó certificado de discapacidad, de todos los miembros del hogar con discapacidad? = 1 y D06_1 = 1-> IMAGEN <> BLANCO)");
					  errmsg("Persona: %d ,Documentos: %d, D06_1: %d", (LD06(i)), (D106), (D06_1(i)));
					  errmsg("------------------");
					  errmsg(" ");
				  ENDIF;
			   ENDIF;  

			   IF D06_1(i)  in 6 THEN
				 IF fileexist(nomeArch) THEN
					  errmsg("DOC-ERR006.2B, D106 ¿Presentó certificado de discapacidad, de todos los miembros del hogar con discapacidad? = 1 y D06_1 = 6 y IMAGEN <> BLANCO)");
					  errmsg("Persona: %d ,Documentos: %d, D06_1: %d", (LD06(i)), (D106), (D06_1(i)));
					  errmsg("------------------");
					  errmsg(" ");
				  ENDIF;
			   ENDIF;  

			enddo;
		ENDIF;
		
//******************************************¿Presentó certificado de enfermedad de todos los miembros del hogar declarados enfermo?**********************************************************************************************
  IF NOT (D107) IN 1,6 THEN
	 //CONTROLA();
	 errmsg("DOC-ERR007, D107 ¿Presentó certificado de enfermedad de todos los miembros del hogar declarados enfermo? <> 1,6 [%d]", (D107)); 
	 errmsg("------------------");
	 errmsg(" ");
  ENDIF;	

	IF (D107) IN 6 AND TOTOCC(REG_D07_EDT) > 0 THEN
	//CONTROLA();
		errmsg("DOC-ERR007.1, D107 ¿Presentó certificado de enfermedad, de todos los miembros del hogar? = 6 -> Registro de Discapacidad = BLANCO, 0)");
		errmsg("Filtro enfermedad: %d  Registro de Documentos: %d", D107, TOTOCC(REG_D07_EDT));
		errmsg("------------------");
		errmsg(" ");
	ENDIF;

	IF (D107) IN 1 AND TOTOCC(REG_D07_EDT) = 0 THEN
	//CONTROLA();
		errmsg("DOC-ERR007.2, D107 ¿Presentó certificado de enfermedad, de todos los miembros del hogar? = 1 y Registro de enfermedad = 0)");
		errmsg("Filtro enfermedad: %d  Registro de Documentos: %d", D107, TOTOCC(REG_D07_EDT));
		errmsg("------------------");
		errmsg(" ");
	ENDIF;

	IF D107 IN 1 THEN

		IF TOTOCC(REG_D07_EDT) > 0 THEN 
			 do i=1 while i <= TOTOCC(REG_D07_EDT);
			   nomeArch= strip(notasName)+"base_fotos\"+strip(ci_clave)+"_"+maketext ("%d",(LD07(i)))+"_EST_FOTO_D07_1.jpg";
			   IF D07_1(i)  in 1 THEN
				   IF !fileexist(nomeArch) THEN
					  errmsg("DOC-ERR007.3, D107 ¿Presentó certificado de discapacidad, de todos los miembros del hogar con discapacidad? = 1 y D07_1 = 1-> IMAGEN <> BLANCO)");
					  errmsg("Persona: %d ,Documentos: %d, D07_1: %d, fotos: %d", (LD06(i)), (D107), (D07_1(i)),  (EST_FOTO_D07_1(i)));
					  errmsg("------------------");
					  errmsg(" ");
				  ENDIF;
			   ENDIF;  
			   IF D07_1(i)  in 6 THEN
				   IF fileexist(nomeArch) THEN
					  errmsg("DOC-ERR007.4, D107 ¿Presentó certificado de discapacidad, de todos los miembros del hogar con discapacidad? = 1 y D07_1 = 6 y IMAGEN <> BLANCO)");
					  errmsg("Persona: %d ,Documentos: %d, D07_1: %d, fotos: %d", (LD06(i)), (D107), (D07_1(i)),  (EST_FOTO_D07_1(i)));
					  errmsg("------------------");
					  errmsg(" ");
				  ENDIF;
			   ENDIF;  

			enddo;
		ENDIF;
	ENDIF;

//******************************************¿Presentó carnet indígena?**********************************************************************************************
		 
		 IF NOT (D108) IN 1,6 THEN
			 //CONTROLA();
			 errmsg("DOC-ERR008, D108 ¿Presentó carnet indígena? <> 1,6 [%d]", (D106)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;	
		
		nomeArch= strip(notasName)+"base_fotos\"+strip(ci_clave) +"_D08_1.jpg";  
		IF (D108) IN 1 AND !fileexist(nomeArch) THEN   // 200727                                   // R200429
				errmsg("DOC-ERR008.1, D108 ¿Presentó carnet indígena? = 1 -> D108_1 <> BLANCO)");   // 200727  // R200429
				errmsg("Documentos: %d", (D108));
				errmsg("------------------");
				errmsg(" ");
		  ENDIF;

		IF (D108) IN 6 AND fileexist(nomeArch) THEN   // 200727                                   // R200429
				errmsg("DOC-ERR008.1B, D108 ¿Presentó carnet indígena? = 6 y D108_1 <> BLANCO)");   // 200727  // R200429
				errmsg("Documentos: %d", (D108));
				errmsg("------------------");
				errmsg(" ");
		  ENDIF;
		  
//******************************************FOTO VIVIENDA**************************************************************************		  
		nomeArch= strip(notasName)+"base_fotos\"+strip(ci_clave) +"_D09.jpg";  
		IF !fileexist(nomeArch) THEN
		//CONTROLA();
			errmsg("DOC-ERR009, D109 FOTO DE LA VIVIENDA NO DEBE ESTAR BLANCO)");   // 200727  // R200429
			errmsg("FOTO: %d", (D109));
			errmsg("------------------");
			errmsg(" ");
		ENDIF;  
	
//******************************************FOTO POSTULANTE**************************************************************************		  
		 nomeArch= strip(notasName)+"base_fotos\"+strip(ci_clave) +"_D10.jpg"; 
		 IF !fileexist(nomeArch) THEN                             // R200429
			//CONTROLA();
				errmsg("DOC-ERR010, D110 FOTO DEL POSTULANTE NO DEBE ESTAR BLANCO)");   // 200727  // R200429
				errmsg("FOTO: %d", (D110));
				errmsg("------------------");
				errmsg(" ");
		 ENDIF;  
		  
//******************************************FOTO VIVIENDA CON POSTULANTE**************************************************************************		  
		 nomeArch= strip(notasName)+"base_fotos\"+strip(ci_clave) +"_D11.jpg"; 
		 IF !fileexist(nomeArch) THEN                           // R200429
			//CONTROLA();
				errmsg("DOC-ERR011, D111 FOTO DE LA VIVIENDA Y DEL POSTULANTE NO DEBE ESTAR BLANCO)");   // 200727  // R200429
				errmsg("FOTO: %d", (D111));
				errmsg("------------------");
				errmsg(" ");
		 ENDIF;  
//******************************************FIRMA DEL POSTULANTE**************************************************************************		  
		nomeArch= strip(notasName)+"base_fotos\"+strip(ci_clave) +"_D112.jpg";  
		IF !fileexist(nomeArch) THEN
				errmsg("DOC-ERR012, D112 FIRMA DEL POSTULANTE NO DEBE ESTAR BLANCO)");   // 200727  // R200429
				errmsg("FOTO: %d", (D112));
				errmsg("------------------");
				errmsg(" ");
		 ENDIF;
	
	ENDIF;
	
//******************************************Falta documentos**********************************************************************************************
		  
		  IF NOT (D113) IN 1,6 THEN
			 //CONTROLA();
			 errmsg("DOC-ERR013, D113 Falta documentos <> 1,6 [%d]", (D113)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;	

		  IF (D113) IN 1 THEN
			 //CONTROLA();
			 errmsg("DOC-VER014, Faltan documentos [%d]", (D113)); 
			 errmsg("------------------");
			 errmsg(" ");
		  ENDIF;			  
PROC XVAL07

	errmsg( "                                      ");
	errmsg( "----------------------------------------------------");
	errmsg( "                   LISTADO DE NOTAS");
	errmsg( "----------------------------------------------------");
	errmsg( "                                      ");
	//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
	//aqui obtenemos las notas mediante sqlquery
	//hacer un file copy a ltmpval
    
	string file_name02;
    
	//file_name02= pathconcat(Dir_main,"Tmpval",concat(strip(CI_CLAVE ),".csdb")); 
	if xoperacion="1" then
       file_name02= concat(aux_ruta_note02,"\",concat(strip(CI_CLAVE ),".csdb"));
	//endif;

	//if xoperacion="2" then
       //file_name02= concat(aux_ruta_note02,"\",concat("Base_unida",".csdb"));
	//endif;
	
		array string campos_notes(1000, 4);
		list string verifiedCaseKeys;
		//obtenemos el total de registros de notas
		sqlquery(IMESPPBI_DICT, verifiedCaseKeys, 
		"SELECT  cases.key, notes.field_name,notes.record_occurrence,notes.content  from notes join cases on notes.case_id = cases.id;");
		//obtenemos los campos dentro de una consulta
		//sqlquery(file_name02, campos_notes, 
		sqlquery(IMESPPBI_DICT, campos_notes, 
		"SELECT  cases.key, notes.field_name,notes.record_occurrence,notes.content  from notes join cases on notes.case_id = cases.id;");
		//colocamos referencia acerca de las variables en los módulos
		errmsg("%s",concat("CI: ",strip(CI_CLAVE )));
		errmsg("%s","");
		errmsg("%s","Referencia para Listado de Personas");
		errmsg("%s","L02 : línea de la persona");
		errmsg("%s","LP103	: Edad en el listado");
		errmsg("%s","LP101	: Nombre en el listado");
		errmsg("%s","");
		errmsg("%s","Referencia para Postulante (***)");
		errmsg("%s","PL02 : línea de la persona");
		errmsg("%s","LP103  : Edad utilizado en ***");
		errmsg("%s","LP101 : Nombre en *** ");
		errmsg("%s","");
		errmsg("%s","Referencia para Población, Educación, Empleo (***)");
		errmsg("%s","L02 : línea de la persona");
		errmsg("%s","LP103  : Edad utilizado en ***");
		errmsg("%s","LP101 : Nombre en *** ");
		errmsg("%s","");
		errmsg("%s","PL1X  : Postulante - Preguntas 1 a 16 ");
		errmsg("%s","LP1X  : Población - Preguntas 1 a 14 ");
		errmsg("%s","GM15X  : Empleo    - Preguntas 15 a 26");
		errmsg("%s","V1X  : Vivienda - Preguntas 1 a 18");
		errmsg("%s","D1X : Documentación - Preguntas 1 a 8");

		errmsg("%s","");

		do numeric ctr = 1 while ctr <= verifiedCaseKeys.length()
			   {errmsg("Clave     : %s", campos_notes(ctr,1));
			   errmsg("Variable  : %s", campos_notes(ctr,2));
			   errmsg("Ocurrencia: %s", campos_notes(ctr,3));
			   errmsg("Contenido : %s", campos_notes(ctr,4));}
			errmsg("%s",concat(
											maketext("%v(%v) = ",campos_notes(ctr,2),campos_notes(ctr,3)),
											maketext("%v",campos_notes(ctr,4))));		   
		enddo;

		//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
	endif;
	
close(PFFILE);


//#if only_consis = 1 then
    //----------------------------------------------------------------------------------------------------------------
	//aqui obtenemos las notas mediante sqlquery
	{string file_name02;
	file_name02= pathconcat(Application,"Tmpval",CONCAT(edit("99999",tonumber(aux_upm02)), edit("999",tonumber(aux_viv02)), edit("9", tonumber(aux_hog02)),".csdb")); 
	//---------------------------------------------------------------------------------------------
	array string campos_notes(1000, 4);
	list string verifiedCaseKeys;
	//---------------------------------------------------------------------------------------------
	sqlquery(TURISMO_DIC, verifiedCaseKeys, 
	"SELECT  cases.key, notes.field_name,notes.record_occurrence,notes.content  from notes join cases on notes.case_id = cases.id;");
	//---------------------------------------------------------------------------------------------

	sqlquery(file_name02, campos_notes, 
	"SELECT  cases.key, notes.field_name,notes.record_occurrence,notes.content  from notes join cases on notes.case_id = cases.id;");


	// aqui genera un archivo cluster_cod_encuestador-> xxxxx_xxx.work
	AUX_RUTA=pathconcat(Application,  "Tmpval",concat(strip(AUX_CLAVE),".TX3"));  
	file pffile_88;
	
	setfile(pffile_88,strip(AUX_RUTA));
	//*if !fileexist(pffile_88) then 
	filecreate(pffile_88); }
	
	{filewrite(pffile_88,"%s",concat("UPM: ",edit("99999",tonumber(aux_upm02)),"-"," Vivienda: ",edit("999",tonumber(aux_viv02)),"-", " Hogar: ",edit("9", tonumber(aux_hog02))));
	filewrite(pffile_88,"%s","");
	filewrite(pffile_88,"%s","Referencia para Listado de Personas");
	filewrite(pffile_88,"%s","L01     : línea de la persona");
	filewrite(pffile_88,"%s","EDAD01  : Edad en el listado");
	filewrite(pffile_88,"%s","NOMBRE01: Nombre en el listado");
	filewrite(pffile_88,"%s","");
	filewrite(pffile_88,"%s","Referencia para Población, Educación, Empleo y Turismo (***)");
	filewrite(pffile_88,"%s","L02     : línea de la persona");
	filewrite(pffile_88,"%s","EDAD02  : Edad utilizado en ***");
	filewrite(pffile_88,"%s","NOMBRE02: Nombre en *** ");
	filewrite(pffile_88,"%s","");
	filewrite(pffile_88,"%s","S3_Px   : Población - Preguntas 2,3,5,6 y 7 ");
	filewrite(pffile_88,"%s","S4_Px   : Educación - Preguntas 1 a 4 ");
	filewrite(pffile_88,"%s","S5_Px   : Empleo    - Preguntas 1 a 15");
	filewrite(pffile_88,"%s","S6_Px   : Turismo   - Preguntas 1 a 17");
	filewrite(pffile_88,"%s","");}
	
	{do numeric ctr = 1 while ctr <= verifiedCaseKeys.length()
		   {errmsg("Clave     : %s", campos_notes(ctr,1));
		   errmsg("Variable  : %s", campos_notes(ctr,2));
		   errmsg("Ocurrencia: %s", campos_notes(ctr,3));
		   errmsg("Contenido : %s", campos_notes(ctr,4));}
		filewrite(pffile_88,"%s",concat(
										maketext("%v(%v) = ",campos_notes(ctr,2),campos_notes(ctr,3)),
										maketext("%v",campos_notes(ctr,4))));		   
	enddo;
	
	close(pffile_88); }
	//---------------------------------------------------------------------------------------------

	//**errmsg("El listado de consistencia fue generado...");

	//RunListado();

	//*back_Entry();
//#endif;
PROC L02
 
// errmsg("  paso 79 ");	 
		IF COUNT (IMESPPBI_DICT.REG_GENERAL) > 0 and SITU in 1,2 THEN
		//**FILEWRITE(PFFILE,"002- pasó por lista personas");
		
			numeric CUENTAJ, CUENTA1, CUENTAC, LINJ, LINC, DIFE;
			numeric PER, Postulante;	
			
			CUENTAJ = COUNT(REG_GENERAL WHERE GM101 = 1 AND LP102 = 1);  
			
			//errmsg("  paso 80 ");	  
			
			IF CUENTAJ = 0 THEN
			   errmsg("  paso 81 "); 
			   errmsg("ERROR020.  NO se registra POSTULANTE EN EL HOGAR [%02d]", CUENTA1);
			   errmsg("Módulo Postulante");
			   errmsg("  ");
			ENDIF;

			IF CUENTAJ > 1 THEN
			   errmsg("  paso 82 ");
			   errmsg("ERROR021.  Se registra más de 1 POSTULANTE EN EL HOGAR [%02d]", CUENTA1);
			   errmsg("Módulo Postulante");
			   errmsg("  ");
			ENDIF;

			//EDADJ = 0;

		endif;

